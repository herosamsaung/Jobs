<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>لوحة تحكم وظائف رؤيا</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
  <link rel="icon" href="https://www2.0zz0.com/2025/10/15/20/337819623.png">
  <style>
    :root {
      --purple: #4b1979;
      --purple-grad: linear-gradient(90deg, #7f38c0 0%, #4b1979 100%);
      --purple-btn: linear-gradient(90deg, #a259c4 0%, #7f38c0 100%);
      --white: #fff;
      --shadow: 0 8px 32px #4b197914;
      --gold: #b88f27;
      --gray: #f9f7fa;
      --danger: #e6415d;
      --green: #43b968;
    }
    body {
      margin: 0;
      font-family: 'Cairo', Arial, sans-serif;
      background: #f7f4fb;
      color: var(--purple);
      min-height: 100vh;
    }
    .header {
      background: var(--purple);
      color: var(--white);
      text-align: center;
      padding: 34px 10px 16px;
      position: relative;
    }
    .header img {
      width: 60px; height: 60px;
      border-radius: 15px;
      background: var(--white);
      border: 3px solid #fff;
      margin-bottom: 10px;
      box-shadow: var(--shadow);
    }
    .header h1 {
      font-size: 2rem;
      font-weight: 900;
      margin: 8px 0;
      letter-spacing: .5px;
    }
    .logout-btn {
      position: absolute;
      left: 18px; top: 18px;
      background: #fff;
      color: var(--purple);
      font-weight: 700;
      padding: 7px 22px;
      border: none;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      box-shadow: 0 2px 12px #7f38c034;
      transition: background .2s;
    }
    .logout-btn:hover { background: #f2e7fa;}
    .tabs {
      display: flex;
      justify-content: center;
      margin: 0;
      background: #fff;
      border-radius: 0 0 24px 24px;
      box-shadow: 0 1px 8px #4b197918;
      position: relative;
      top: -8px;
      z-index: 3;
    }
    .tab-btn {
      background: none;
      border: none;
      padding: 19px 38px 10px 38px;
      font-size: 1.11rem;
      font-weight: 700;
      color: #7f38c0;
      cursor: pointer;
      border-bottom: 4px solid transparent;
      transition: color .2s, border .2s;
      outline: none;
    }
    .tab-btn.active {
      color: var(--purple);
      border-bottom: 4px solid var(--purple);
    }
    .container {
      max-width: 950px;
      margin: 34px auto 30px auto;
      background: #fff;
      border-radius: 22px;
      box-shadow: var(--shadow);
      padding: 34px 18px 44px 18px;
    }
    .tab-content { display: none; }
    .tab-content.active { display: block; }
    .add-jobs-btn {
      background: var(--green);
      color: #fff;
      border: none;
      padding: 9px 22px;
      border-radius: 13px;
      font-size: 1.05rem;
      font-weight: 800;
      box-shadow: 0 2px 12px #43b96833;
      cursor: pointer;
      margin-bottom: 13px;
      margin-top: 6px;
      transition: background .2s;
    }
    .add-jobs-btn:active {background: #36994a;}
    /* جدول الوظائف والمستخدمين */
    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 30px;
      background: #fff;
    }
    th, td {
      border: 1px solid #eee;
      padding: 10px 6px;
      text-align: right;
      font-size: 1.01rem;
    }
    th {
      background: var(--purple);
      color: #fff;
      font-weight: bold;
    }
    tr:nth-child(even) { background: #f2e7fa;}
    .actions button {
      background: var(--purple-btn);
      color: #fff;
      border: none;
      padding: 6px 18px;
      border-radius: 7px;
      font-size: .97rem;
      cursor: pointer;
      transition: background .2s;
      margin-left: 8px;
    }
    .actions button.delete {
      background: #e6415d;
    }
    .actions button:active {
      opacity: .8;
    }
    .add-job-form input, .add-job-form textarea, .add-job-form select {
      width: 100%;
      padding: 10px 11px;
      margin-bottom: 14px;
      background: #fff;
      border: 1.5px solid #d0b8e4;
      border-radius: 9px;
      font-size: 1.08rem;
      font-family: inherit;
      outline: none;
      transition: border .2s;
      box-sizing: border-box;
    }
    .add-job-form input:focus, .add-job-form textarea:focus, .add-job-form select:focus {
      border-color: #7f38c0;
    }
    .add-job-form button {
      background: var(--purple-btn);
      color: #fff;
      border: none;
      padding: 11px 0;
      width: 100%;
      border-radius: 14px;
      font-size: 1.08rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 7px;
      box-shadow: 0 3px 16px #7f38c034;
      transition: background .2s;
    }
    .add-job-form button:active { background: var(--purple);}
    /* Responsive */
    @media (max-width:900px) {.container {padding:13px;}}
    @media (max-width:600px) {
      .header h1 { font-size: 1.18rem;}
      .container { padding: 8px;}
      .tab-btn { padding: 14px 12px 8px 12px; font-size:.98rem;}
      th,td { font-size: .93rem;}
    }
    .notify {
      position: fixed;
      top: 20px;
      right: 50%;
      transform: translateX(50%);
      background: var(--purple-btn);
      color: #fff;
      padding: 16px 32px;
      border-radius: 18px;
      font-size: 1.13rem;
      font-weight: 700;
      box-shadow: 0 2px 16px #7f38c044;
      z-index: 99999;
      display: none;
      animation: fadeIn .5s;
    }
    @keyframes fadeIn {
      from { opacity:0; top:10px;}
      to { opacity:1; top:20px;}
    }
    ::-webkit-scrollbar { width: 9px;}
    ::-webkit-scrollbar-thumb { background: #7f38c034; border-radius: 6px;}
    ::selection { background: #7f38c022; }
  </style>
</head>
<body>
  <div class="header">
    <img src="https://www2.0zz0.com/2025/10/15/20/337819623.png" alt="شعار رؤيا">
    <h1>لوحة تحكم وظائف رؤيا</h1>
    <button class="logout-btn" onclick="logout()">تسجيل الخروج</button>
  </div>
  <div class="tabs">
    <button class="tab-btn active" onclick="showTab('jobsTab')">الوظائف</button>
    <button class="tab-btn" onclick="showTab('usersTab')">المستخدمون</button>
  </div>
  <div class="container">
    <!-- الوظائف -->
    <div id="jobsTab" class="tab-content active">
      <button class="add-jobs-btn" onclick="addSampleJobs()">إضافة 150 وظيفة جاهزة</button>
      <form class="add-job-form" id="jobForm">
        <input required type="text" id="jobTitle" placeholder="المسمى الوظيفي">
        <input required type="text" id="jobCompany" placeholder="اسم الشركة">
        <input required type="number" id="jobSalary" placeholder="الراتب (دينار)" min="300" max="4000">
        <input required type="number" id="jobHours" placeholder="عدد ساعات العمل" min="5" max="12">
        <select required id="jobLocation">
          <option value="">المحافظة</option>
          <option>عمان</option><option>إربد</option><option>الزرقاء</option>
          <option>العقبة</option><option>جرش</option><option>المفرق</option>
          <option>عجلون</option><option>البلقاء</option><option>معان</option>
          <option>الكرك</option><option>مادبا</option><option>الطفيلة</option>
        </select>
        <textarea required id="jobDesc" rows="3" placeholder="وصف الوظيفة"></textarea>
        <button type="submit">إضافة وظيفة</button>
      </form>
      <table>
        <thead>
          <tr>
            <th>المسمى</th>
            <th>الشركة</th>
            <th>الراتب</th>
            <th>الساعات</th>
            <th>المحافظة</th>
            <th>الوصف</th>
            <th>التاريخ</th>
            <th>إجراءات</th>
          </tr>
        </thead>
        <tbody id="jobsTableBody"><tr><td colspan="8" style="text-align:center;">جارٍ التحميل...</td></tr></tbody>
      </table>
    </div>
    <!-- المستخدمون -->
    <div id="usersTab" class="tab-content">
      <table>
        <thead>
          <tr>
            <th>الاسم</th>
            <th>الهاتف</th>
            <th>المحافظة</th>
            <th>تاريخ التسجيل</th>
          </tr>
        </thead>
        <tbody id="usersTableBody"><tr><td colspan="4" style="text-align:center;">جارٍ التحميل...</td></tr></tbody>
      </table>
    </div>
  </div>
  <div class="notify" id="notify"></div>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <script>
    // Firebase config
    const firebaseConfig = {
      apiKey: "AIzaSyCtvxXiWWZ4GxWxz1rAhu9nRwiFlkiKMtA",
      authDomain: "royanew-a02f3.firebaseapp.com",
      projectId: "royanew-a02f3",
      storageBucket: "royanew-a02f3.appspot.com",
      messagingSenderId: "640968299159",
      appId: "1:640968299159:web:590e4256ad1492ca19cfd2",
      measurementId: "G-69TLG6LYYK",
      databaseURL: "https://royanew-a02f3-default-rtdb.firebaseio.com"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // إشعار جميل
    function notify(msg, time=2700) {
      let n = document.getElementById('notify');
      n.innerText = msg;
      n.style.display = 'block';
      setTimeout(()=>{ n.style.display = 'none'; }, time);
    }

    // Tabs
    function showTab(tabId) {
      document.querySelectorAll('.tab-content').forEach(tab => tab.classList.remove('active'));
      document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
      document.getElementById(tabId).classList.add('active');
      document.querySelector(`.tab-btn[onclick="showTab('${tabId}')"]`).classList.add('active');
      if(tabId==='jobsTab') loadJobs();
      if(tabId==='usersTab') loadUsers();
    }

    // --- الوظائف ---
    function loadJobs() {
      const tbody = document.getElementById('jobsTableBody');
      tbody.innerHTML = `<tr><td colspan="8" style="text-align:center;">جارٍ التحميل...</td></tr>`;
      db.ref('jobs').orderByChild('timestamp').once('value', (snap) => {
        let rows = [];
        snap.forEach(child => {
          let job = child.val();
          rows.unshift(`
            <tr>
              <td>${job.title}</td>
              <td>${job.company||''}</td>
              <td>${job.salary||''}</td>
              <td>${job.hours||''}</td>
              <td>${job.location||''}</td>
              <td style="max-width:180px;white-space:pre-line;">${job.description?job.description.replace(/\n/g,"<br>"):""}</td>
              <td>${new Date(job.timestamp).toLocaleDateString('ar-JO')}</td>
              <td class="actions">
                <button onclick="editJob('${child.key}')">تعديل</button>
                <button class="delete" onclick="deleteJob('${child.key}')">حذف</button>
              </td>
            </tr>
          `);
        });
        tbody.innerHTML = rows.length ? rows.join('') : `<tr><td colspan="8" style="text-align:center;">لا توجد وظائف</td></tr>`;
      });
    }
    // إضافة وظيفة
    const jobForm = document.getElementById('jobForm');
    let editingId = null;
    jobForm.onsubmit = function(e){
      e.preventDefault();
      const title = jobTitle.value.trim();
      const company = jobCompany.value.trim();
      const salary = +jobSalary.value;
      const hours = +jobHours.value;
      const location = jobLocation.value;
      const description = jobDesc.value.trim();
      if (!title || !company || !salary || !hours || !location || !description) {
        notify('يرجى تعبئة جميع الحقول');
        return;
      }
      const data = {
        title, company, salary, hours, location, description, timestamp: Date.now()
      };
      if(editingId){
        db.ref('jobs/'+editingId).set(data).then(()=>{
          notify('تم تعديل الوظيفة');
          jobForm.reset();
          editingId = null;
          jobForm.querySelector('button').innerText = "إضافة وظيفة";
          loadJobs();
        });
      }else{
        db.ref('jobs').push(data).then(()=>{
          notify('تمت إضافة الوظيفة');
          jobForm.reset();
          loadJobs();
        });
      }
    }
    // حذف وظيفة
    function deleteJob(key) {
      if(confirm('هل أنت متأكد من حذف الوظيفة؟')) {
        db.ref('jobs/'+key).remove().then(()=>{
          notify('تم حذف الوظيفة');
          loadJobs();
        });
      }
    }
    // تعديل وظيفة
    function editJob(key) {
      db.ref('jobs/'+key).once('value', snap=>{
        const job = snap.val();
        jobTitle.value = job.title||"";
        jobCompany.value = job.company||"";
        jobSalary.value = job.salary||"";
        jobHours.value = job.hours||"";
        jobLocation.value = job.location||"";
        jobDesc.value = job.description||"";
        editingId = key;
        jobForm.querySelector('button').innerText = "تحديث الوظيفة";
        jobTitle.focus();
      });
    }
    // --- إضافة 150 وظيفة جاهزة ---
    function addSampleJobs() {
      if(!confirm("سيتم إضافة 150 وظيفة متنوعة. تابع؟")) return;
      const titles = [
        "محاسب", "مهندس برمجيات", "مندوب مبيعات", "سكرتيرة", "سائق", "طبيب عام",
        "معلم/ة", "ممرض/ة", "فني كهرباء", "مطور مواقع", "مدير مشاريع", "محلل بيانات",
        "مندوب توصيل", "موظف استقبال", "موظف موارد بشرية", "مدير تسويق", "خبير شبكات",
        "مدخل بيانات", "أخصائي دعم فني", "محامي", "مندوب علاقات عامة", "مساعد إداري",
        "موظف خدمات", "كاشير", "شيف مطبخ", "عامل نظافة", "مراقب جودة", "أخصائي تسويق رقمي",
        "مهندس مدني", "مهندس معماري", "مصمم جرافيك", "فني ميكانيك", "فني صيانة", "مراقب مخزون",
        "أخصائي تغذية", "مدرب رياضي", "مدير مالي", "مدير مشتريات", "موظف بنك", "حارس أمن",
        "خدمة عملاء", "مصور", "كاتب محتوى", "مطور تطبيقات", "مهندس شبكات", "أخصائي موارد بشرية",
        "أخصائي وسائل تواصل", "أخصائي مختبر", "مندوب تسويق", "مساعد طبيب", "مدير مكتب",
        "محاسب تكاليف", "مدير إنتاج", "محاسب رواتب", "محاسب عملاء", "مندوب مشتريات", "فني تكييف",
        "مساعد محاسب", "أخصائي ضبط جودة", "أخصائي مبيعات", "مدير علاقات عامة", "فني إلكترونيات",
        "أخصائي أمن معلومات", "مهندس كهرباء", "مدير خدمة عملاء", "أخصائي تسويق ميداني", "مهندس إنتاج",
        "مساعد إداري تنفيذي", "مسؤول مشتريات", "أخصائي تحليل نظم", "مدير وحدة تدريب", "محلل استثمار",
        "محاسب أول", "مدير مبيعات", "مساعد مدير", "قانوني", "معاون إداري", "محاسب ضرائب", "أخصائي موارد مالية",
        "مسؤول علاقات حكومية", "مدير قسم", "فني مختبرات طبية", "أخصائي تطوير أعمال", "أخصائي موارد بشرية أول",
        "مساعد تسويق", "موظف استقبال زوار", "موظف استقبال هاتف", "مراقب دوام", "أخصائي أمن صناعي",
        "فني صوتيات", "مشرف خدمات", "أمين مستودع", "فني بصريات", "فني أشعة", "فني أسنان", "مراقب أمن",
        "محلل مالي", "فني طباعة", "أخصائي علاقات عامة", "مدير علاقات عامة أول", "فني شبكات حاسوب",
        "أخصائي إدارة مشاريع", "مدير إنتاج صناعي", "محاسب تكاليف صناعية", "أخصائي دعم فني أول", "مساعد مدير مشروع",
        "مدير صيانة", "أخصائي تقارير", "مدير خدمة ما بعد البيع", "محلل عمليات", "مدير تسويق رقمي",
        "مساعد مدير تسويق", "فني إلكترونيات صناعية", "محلل بيانات أول", "منسق شحن", "مدير لوجستيات",
        "مهندس جودة", "محاسب مستودعات", "أخصائي تسويق إلكتروني", "مدير شؤون موظفين", "موظف استقبال مرضى",
        "أخصائي تخطيط موارد", "مساعد محاسب أول", "مساعد مدير مكتب", "مساعد إداري أول", "مساعد مدير مكتب تنفيذي",
        "أخصائي نظم معلومات", "مدير مختبر", "مدير موارد بشرية", "مدير إدارة المخاطر", "مساعد مدير مالي",
        "أمين مكتبة", "فني أجهزة طبية", "محاسب ضرائب أول", "أخصائي تطوير برمجيات", "أخصائي اتصالات",
        "محاسب بنوك", "مساعد مدير علاقات عامة", "مساعد مدير تسويق رقمي", "محلل أعمال", "أخصائي تكنولوجيا معلومات",
        "مشرف مبيعات", "مساعد مدير لوجستيات", "أخصائي تدريب", "محاسب أول عملاء", "أخصائي ذكاء أعمال"
      ];
      const companies = ["رؤيا", "زين", "أمنية", "شركة كبرى", "مستشفى الحياة", "مدارس الأمل", "مطاعم النخبة", "مؤسسة السلام", "شركة القيصر", "شركة الخليج"];
      const descs = [
        "فرصة عمل مميزة، بيئة عمل محفزة، وامتيازات رائعة.",
        "دوام مرن وأجواء عمل عائلية.",
        "رواتب مجزية وحوافز شهرية.",
        "تأمين صحي وبدل مواصلات.",
        "الوظيفة متاحة للجنسين مع فرص تطوير.",
        "العمل ضمن فريق شاب وطموح.",
        "امتيازات عديدة وتدريب مدفوع الأجر.",
        "الراتب حسب الكفاءة مع زيادات سنوية.",
        "الوظيفة مناسبة للخريجين الجدد وذوي الخبرة."
      ];
      const govs = ["عمان","إربد","الزرقاء","العقبة","جرش","المفرق","عجلون","البلقاء","معان","الكرك","مادبا","الطفيلة"];
      let jobs = [];
      for(let i=0;i<150;i++){
        jobs.push({
          title: titles[i%titles.length],
          company: companies[Math.floor(Math.random()*companies.length)],
          salary: Math.floor(Math.random()*951)+550,
          hours: [7,8,9,10][Math.floor(Math.random()*4)],
          location: govs[Math.floor(Math.random()*govs.length)],
          description: descs[Math.floor(Math.random()*descs.length)],
          timestamp: Date.now() + i*10
        });
      }
      let count = 0;
      jobs.forEach(job=>{
        db.ref('jobs').push(job, ()=>{count++; if(count===jobs.length){notify("تمت إضافة 150 وظيفة!"); loadJobs();}});
      });
    }
    // --- المستخدمون ---
    function loadUsers() {
      const tbody = document.getElementById('usersTableBody');
      tbody.innerHTML = `<tr><td colspan="4" style="text-align:center;">جارٍ التحميل...</td></tr>`;
      db.ref('users').orderByChild('timestamp').once('value', (snap) => {
        let rows = [];
        snap.forEach(child => {
          let user = child.val();
          rows.unshift(`
            <tr>
              <td>${user.username || ''}</td>
              <td>${user.phone || ''}</td>
              <td>${user.governorate || ''}</td>
              <td>${user.timestamp ? new Date(user.timestamp).toLocaleDateString('ar-JO') : ''}</td>
            </tr>
          `);
        });
        tbody.innerHTML = rows.length ? rows.join('') : `<tr><td colspan="4" style="text-align:center;">لا يوجد مستخدمون</td></tr>`;
      });
    }
    // تسجيل خروج (إعادة تحميل الصفحة)
    function logout() {
      if(confirm('هل تريد تسجيل الخروج من لوحة التحكم؟')) location.reload();
    }
    // تحميل الوظائف والمستخدمين عند فتح الصفحة
    loadJobs();
  </script>
</body>
</html>