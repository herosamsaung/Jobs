<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <title>Ø¨ÙˆØ§Ø¨Ø© ÙˆØ¸Ø§Ø¦Ù Ø±Ø¤ÙŠØ§ | Ø§Ù„Ø£Ø±Ø¯Ù†</title>
  <meta name="viewport" content="width=device-width,initial-scale=1.0"/>
  <link href="https://fonts.googleapis.com/css?family=Tajawal:400,700&display=swap" rel="stylesheet">
  <style>
    body {
      font-family: 'Tajawal', Arial, sans-serif;
      background: linear-gradient(135deg, #f8fafc 0%, #e4ecf7 100%);
      margin: 0; padding: 0; color: #222; min-height: 100vh; position: relative;
      transition: background 0.3s, color 0.3s;
    }
    body.dark {
      background: linear-gradient(135deg, #18152b 0%, #321e53 100%);
      color: #e7e5f7;
    }
    header {
      background: #6900ad; color: #fff;
      padding: 20px 0 10px 0; text-align: center; box-shadow: 0 3px 16px #865fc44d;
      position: sticky; top: 0; z-index: 10;
      transition: background 0.3s;
    }
    body.dark header { background: #1e0832; }
    .logo { height: 68px; margin-bottom: 6px; }
    h1 { margin: 0 0 8px 0; font-size: 2.2rem; font-weight: 700; letter-spacing: 1px; }
    .subtitle { font-size: 1.2rem; color: #e5d7f9; margin-bottom: 5px; }
    body.dark .subtitle { color: #cdbff1; }
    .container {
      max-width: 1100px; margin: 32px auto 18px auto; padding: 16px; background: #fff;
      border-radius: 18px; box-shadow: 0 2px 22px #a97be73f; position: relative; z-index: 1;
      transition: background 0.3s, color 0.3s;
    }
    body.dark .container { background: #241740; color: #e7e5f7; }
    .stats {
      display: flex; gap: 20px; justify-content: center; margin: 18px 0 30px 0;
      flex-wrap: wrap;
    }
    .stat {
      background: #6900ad; color: #fff; padding: 18px 32px; border-radius: 15px;
      font-size: 1.1rem; font-weight: 600; box-shadow: 0 1px 4px #0001; text-align: center;
      min-width: 150px;
      transition: background 0.3s, color 0.3s;
    }
    body.dark .stat { background: #38185e; }
    .jobs-list {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(270px, 1fr)); gap: 24px;
    }
    .job-card {
      background: #f7f2ff; border: 2px solid #e4d4f7; border-radius: 14px;
      padding: 24px 20px 16px 20px; box-shadow: 0 1px 8px #a97be712;
      transition: transform 0.1s, background 0.3s, color 0.3s;
      position: relative; overflow: hidden; min-height: 220px;
      display: flex; flex-direction: column; justify-content: space-between;
    }
    body.dark .job-card { background: #2b1d45; color: #ebebf8; border-color: #51306d; }
    .job-title { font-size: 1.23rem; font-weight: bold; color: #6900ad; margin-bottom: 8px; }
    body.dark .job-title { color: #f9d13d; }
    .job-info { font-size: 1.02rem; margin-bottom: 6px; color: #333; }
    body.dark .job-info { color: #e7e5f7; }
    .job-province { font-size: 0.99rem; color: #49007e; margin-bottom: 6px; }
    body.dark .job-province { color: #f9d13d; }
    .salary { font-weight: bold; color: #0a6c19; margin-bottom: 6px; }
    body.dark .salary { color: #89fa8e; }
    .hours { color: #ad6c00; margin-bottom: 6px; }
    body.dark .hours { color: #f9d13d; }
    .apply-btn {
      background: linear-gradient(90deg, #8400d3 0%, #a97be7 100%);
      color: #fff; border: none; border-radius: 10px; padding: 9px 17px;
      font-size: 1.08rem; font-weight: 600; cursor: pointer;
      box-shadow: 0 1px 8px #6900ad2b; transition: background 0.2s;
      margin-top: 8px; align-self: flex-end;
    }
    .apply-btn:hover {
      background: linear-gradient(90deg, #6900ad 0%, #a97be7 100%);
    }
    .fav-btn {
      position:absolute;top:10px;left:10px;background:none;border:none;font-size:1.5rem;cursor:pointer;color:#fdc800;
      z-index:1;
    }
    .fav-btn.fav { color: #f9d13d; }
    /* Modal styles */
    .modal-bg {
      position: fixed; inset: 0; background: #0008; z-index: 10000;
      display: flex; align-items: center; justify-content: center; animation: fadeIn 0.3s;
    }
    .modal {
      background: #fff; border-radius: 16px; max-width: 99vw; width: 440px;
      box-shadow: 0 4px 32px #6900ad3a; padding: 38px 20px 28px 20px; text-align: center; position: relative; animation: slideIn 0.25s;
      transition: background 0.3s, color 0.3s;
    }
    body.dark .modal { background: #251a35; color: #fff; }
    @keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }
    @keyframes slideIn { from { transform: translateY(60px); opacity: 0 } to { transform: none; opacity: 1 } }
    .modal h2 { color: #6900ad; margin-bottom: 20px; }
    body.dark .modal h2 { color: #f9d13d; }
    .modal input, .modal select, .modal textarea {
      width: 92%; padding: 8px 10px; border-radius: 8px; border: 1.5px solid #cbb7eb;
      font-size: 1.08rem; margin-bottom: 16px; direction: rtl; outline: none; transition: border 0.2s;
      background: #fff; color: #222;
    }
    body.dark .modal input, body.dark .modal select, body.dark .modal textarea {
      background: #2b1d45; color: #fff; border-color: #51306d;
    }
    .modal input:focus, .modal select:focus, .modal textarea:focus { border-color: #6900ad; }
    .modal button {
      background: linear-gradient(90deg, #6900ad 0%, #a97be7 100%);
      color: #fff; border: none; border-radius: 10px; padding: 9px 27px;
      font-size: 1.08rem; font-weight: 600; cursor: pointer; box-shadow: 0 1px 8px #6900ad1b; margin-top: 10px;
      transition: background 0.2s;
    }
    .modal .note { color: #ad6c00; font-size: 0.98rem; margin-top: 8px; margin-bottom: 8px; }
    .modal .loader {
      margin: 16px auto; border: 4px solid #eee; border-radius: 50%; border-top: 4px solid #6900ad;
      width: 48px; height: 48px; animation: spin 1s linear infinite;
    }
    @keyframes spin { 100% { transform: rotate(360deg) } }
    .modal .success { color: #0a6c19; font-size: 1.09rem; margin-top: 10px; margin-bottom: 10px; font-weight: bold; }
    body.dark .modal .success { color: #89fa8e; }
    .modal .pay-btn {
      background: linear-gradient(90deg, #e56400 0%, #fbae3c 100%);
      color: #fff; border: none; border-radius: 10px; padding: 10px 34px; font-size: 1.16rem;
      font-weight: 700; margin-top: 22px; cursor: pointer; box-shadow: 0 1px 8px #c89a2a2b;
    }
    .modal .pay-btn:active { background: #e56400 }
    .modal .rating-stars { font-size:1.6rem;margin:8px 0;direction:ltr;}
    .modal .rating-stars span { cursor:pointer; }
    .modal .rates-list { margin:12px 0 0 0;text-align:right;max-height:110px;overflow-y:auto;font-size:1.01rem;}
    .modal .rates-list div { margin-bottom:4px;color:#6900ad; }
    body.dark .modal .rates-list div { color:#f9d13d; }
    .modal .cv-preview { background:#f2f0f8;border-radius:9px;padding:8px 10px;max-height:100px;overflow:auto; }
    /* Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… */
    #dashboard-panel {
      position:fixed;top:0;right:0;width:370px;max-width:93vw;height:100vh;z-index:99999;background:#fff;
      border-radius:0 0 0 16px;box-shadow:-3px 0 20px #6900ad2a;padding:0;display:none;flex-direction:column;
      transition:background 0.3s,color 0.3s;
    }
    body.dark #dashboard-panel { background:#211435;color:#fff; }
    #dashboard-header {
      background:#6900ad;color:#fff;padding:15px 18px;border-radius:0 0 0 16px;display:flex;align-items:center;justify-content:space-between;
    }
    body.dark #dashboard-header { background:#2e1a55; }
    #dashboard-content { padding:18px 14px; overflow-y:auto; flex:1; }
    #dashboard-tabs { display:flex;gap:7px;margin:2px 0 13px 0; }
    #dashboard-tabs button {
      background:#efecfa;border:1px solid #bba9e7;border-radius:8px;color:#6900ad;
      padding:7px 12px;font-size:1.05rem;cursor:pointer;transition:.2s;
    }
    #dashboard-tabs button.active, #dashboard-tabs button:hover { background:#6900ad;color:#fff; }
    body.dark #dashboard-tabs button { background:#3a255a;color:#fff;border-color:#9e7ccb;}
    body.dark #dashboard-tabs button.active, body.dark #dashboard-tabs button:hover { background:#f9d13d;color:#2e1a55; }
    /* Footer */
    footer {
      background: #f7f2ff; color: #6900ad; text-align: center; padding: 18px 0 10px 0; border-radius: 18px 18px 0 0;
      font-size: 1.07rem; margin: 23px 0 0 0; box-shadow: 0 -2px 12px #a97be71a;
      transition: background 0.3s, color 0.3s;
    }
    body.dark footer { background: #241740; color: #fff; }
    /* Ø´Ø±ÙŠØ· Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
    #jobs-ticker {
      background:#eae2fa;color:#6900ad;padding:7px 0;font-size:1.09rem;text-align:right;overflow:hidden;
      border-bottom:2px solid #6900ad;
      transition:background 0.3s, color 0.3s;
    }
    body.dark #jobs-ticker { background:#321e53;color:#f9d13d;border-color:#f9d13d; }
    /* Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØªÙˆØ³Øª */
    #toast {
      min-width:200px;position:fixed;bottom:95px;left:40px;z-index:10000;background:#6900ad;color:#fff;
      padding:14px 30px;border-radius:12px;display:none;font-size:1.08rem;box-shadow:0 2px 10px #6900ad2b;
      transition:background 0.3s,color 0.3s;
    }
    body.dark #toast { background:#f9d13d;color:#1e0832; }
    /* Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ */
    .wa-btn {
      position:fixed;bottom:30px;left:30px;z-index:9999;background:#25d366;border-radius:50%;width:57px;height:57px;display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px #0002;
      transition:background 0.3s;
    }
    .wa-btn img { width:34px;height:34px; }
    /* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
    #dark-toggle {
      position:fixed;top:24px;left:28px;z-index:11111;background:#fff;border-radius:50%;width:43px;height:43px;display:flex;align-items:center;justify-content:center;
      box-shadow:0 2px 12px #6900ad2b;cursor:pointer;font-size:1.7rem;color:#6900ad;transition:.2s;
    }
    body.dark #dark-toggle { background:#251a35;color:#f9d13d; }
    /* Responsive */
    @media (max-width: 700px) {
      .container { padding: 6px; }
      .stats { flex-direction: column; gap: 12px; }
      .modal { width: 97vw; padding: 28px 3vw 20px 3vw; }
      .job-card { padding: 14px 4px 10px 4px; }
      #dashboard-panel { width:98vw; }
    }
  </style>
  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-app.js";
    import { getDatabase, ref, push, set, get, remove, update, onValue, child } from "https://www.gstatic.com/firebasejs/12.4.0/firebase-database.js";
    window.firebaseInit = () => {
      const firebaseConfig = {
        apiKey: "AIzaSyBr03bRk3uNzLCFzr53ufdPbA3DrOZHxWQ",
        authDomain: "jobsroya.firebaseapp.com",
        projectId: "jobsroya",
        storageBucket: "jobsroya.firebasestorage.app",
        messagingSenderId: "882520191513",
        appId: "1:882520191513:web:2165131b20e33bdc38b088",
        measurementId: "G-RW67K10VPD",
        databaseURL: "https://jobsroya-default-rtdb.firebaseio.com"
      };
      const app = initializeApp(firebaseConfig);
      window.db = getDatabase(app);
      window.refDB = ref;
      window.pushDB = push;
      window.setDB = set;
      window.getDB = get;
      window.removeDB = remove;
      window.updateDB = update;
      window.onValueDB = onValue;
      window.childDB = child;
    };
  </script>
</head>
<body>
  <!-- Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ -->
  <div id="dark-toggle" title="Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ/Ø§Ù„Ù†Ù‡Ø§Ø±ÙŠ">ğŸŒ™</div>

  <!-- Ø²Ø± ÙˆØ§ØªØ³Ø§Ø¨ -->
  <a href="https://wa.me/962799999999" class="wa-btn" target="_blank" title="ØªÙˆØ§ØµÙ„ Ù…Ø¹ Ø§Ù„Ø¯Ø¹Ù…">
    <img src="https://upload.wikimedia.org/wikipedia/commons/6/6b/WhatsApp.svg" alt="ÙˆØ§ØªØ³Ø§Ø¨">
  </a>

  <!-- Ø´Ø±ÙŠØ· Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© Ø§Ù„Ù…ØªØ­Ø±Ùƒ Ø£Ø¹Ù„Ù‰ Ø§Ù„ØµÙØ­Ø© -->
  <div id="jobs-ticker">
    <marquee id="ticker-content" direction="right" scrollamount="5">ğŸ”¥ ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ÙŠÙˆÙ…: Ø³ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡Ø§ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ ... ØªØ§Ø¨Ø¹ ÙƒÙ„ Ø¬Ø¯ÙŠØ¯!</marquee>
  </div>

  <header>
    <img class="logo" src="https://upload.wikimedia.org/wikipedia/commons/thumb/8/8d/ROYA_TV_LOGO.svg/512px-ROYA_TV_LOGO.svg.png" alt="Ø´Ø¹Ø§Ø± Ø±Ø¤ÙŠØ§"/>
    <h1>Ø¨ÙˆØ§Ø¨Ø© ÙˆØ¸Ø§Ø¦Ù Ø±Ø¤ÙŠØ§</h1>
    <div class="subtitle">ÙƒÙ„ ÙØ±Øµ Ø§Ù„Ø¹Ù…Ù„ Ø§Ù„Ù…ØªÙˆÙØ±Ø© ÙÙŠ Ø§Ù„Ø£Ø±Ø¯Ù† Ø¨ÙŠÙ† ÙŠØ¯ÙŠÙƒ â€” Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ù…ØªÙƒØ§Ù…Ù„Ø©</div>
    <button style="position:absolute;top:23px;right:26px;background:#fff;color:#6900ad;font-size:1.07rem;border-radius:8px;padding:5px 16px;border:none;cursor:pointer;font-weight:700;box-shadow:0 1px 8px #6900ad12;z-index:100;" onclick="openDashboardPanel()">
      Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…
    </button>
  </header>

  <div class="container">
    <div class="stats">
      <div class="stat" id="stat-jobs">Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ§Ø­Ø©: <span>--</span></div>
      <div class="stat" id="stat-apps">Ø·Ù„Ø¨Ø§Øª Ø§Ù„ÙŠÙˆÙ…: <span>--</span></div>
      <div class="stat" id="stat-users">Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ† Ø§Ù„Ù…Ø³Ø¬Ù„ÙˆÙ†: <span>--</span></div>
      <div class="stat" id="stat-provinces">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª: <span>12</span></div>
    </div>
    <div style="margin-bottom:14px; text-align:center;">
      <input id="search" type="text" placeholder="Ø§Ø¨Ø­Ø« Ø¹Ù† ÙˆØ¸ÙŠÙØ© Ø£Ùˆ ÙƒÙ„Ù…Ø© Ù…ÙØªØ§Ø­ÙŠØ©..." style="padding:8px 12px; border-radius:8px; border:1.5px solid #cbb7eb; width:260px; font-size:1.03rem; margin-bottom:12px;direction:rtl;" />
      <button id="voice-search-btn" title="Ø¨Ø­Ø« ØµÙˆØªÙŠ" style="background:#e4d4f7;color:#6900ad;border:none;border-radius:8px;padding:8px 14px;margin-right:8px;font-size:1.2rem;cursor:pointer;">ğŸ¤</button>
      <select id="filter-province" style="padding:6px 10px;border-radius:8px;border:1.5px solid #cbb7eb;font-size:1.01rem;margin-right:8px;">
        <option value="">ÙƒÙ„ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø§Øª</option>
        <option>Ø¹Ù…Ø§Ù†</option><option>Ø¥Ø±Ø¨Ø¯</option><option>Ø§Ù„Ø²Ø±Ù‚Ø§Ø¡</option><option>Ø§Ù„Ø¹Ù‚Ø¨Ø©</option>
        <option>Ø§Ù„Ù…ÙØ±Ù‚</option><option>Ø§Ù„Ø³Ù„Ø·</option><option>Ø¬Ø±Ø´</option>
        <option>Ø¹Ø¬Ù„ÙˆÙ†</option><option>Ù…Ø£Ø¯Ø¨Ø§</option><option>Ø§Ù„ÙƒØ±Ùƒ</option>
        <option>Ø§Ù„Ø·ÙÙŠÙ„Ø©</option><option>Ù…Ø¹Ø§Ù†</option>
      </select>
      <select id="filter-type" style="padding:6px 10px;border-radius:8px;border:1.5px solid #cbb7eb;font-size:1.01rem;margin-right:8px;">
        <option value="">ÙƒÙ„ Ø§Ù„Ø£Ù†ÙˆØ§Ø¹</option>
        <option>Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„</option>
        <option>Ø¯ÙˆØ§Ù… Ø¬Ø²Ø¦ÙŠ</option>
        <option>Ø¹Ù‚Ø¯ Ù…Ø¤Ù‚Øª</option>
        <option>Ø¹Ù…Ù„ Ø¹Ù† Ø¨Ø¹Ø¯</option>
        <option>ØªØ¯Ø±ÙŠØ¨</option>
      </select>
      <select id="filter-salary" style="padding:6px 10px;border-radius:8px;border:1.5px solid #cbb7eb;font-size:1.01rem;margin-right:8px;">
        <option value="">ÙƒÙ„ Ø§Ù„Ø±ÙˆØ§ØªØ¨</option>
        <option value="500">500+</option>
        <option value="1000">1000+</option>
        <option value="1500">1500+</option>
      </select>
    </div>
    <div class="jobs-list" id="jobs-list">
      <!-- Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø³ØªØ¸Ù‡Ø± Ù‡Ù†Ø§ -->
    </div>
    <div style="margin-top:28px;text-align:right;">
      <button onclick="exportJobsPDF()" style="background:#6900ad;color:#fff;border:none;border-radius:8px;padding:8px 20px;font-size:1.05rem;cursor:pointer;">ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù PDF</button>
      <button onclick="window.print()" style="background:#f9d13d;color:#6900ad;border:none;border-radius:8px;padding:8px 20px;font-size:1.05rem;cursor:pointer;margin-right:10px;">Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØµÙØ­Ø©</button>
    </div>
  </div>

  <footer>
    Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© &copy; Ù‚Ù†Ø§Ø© Ø±Ø¤ÙŠØ§ 2025 â€” ØªØµÙ…ÙŠÙ… ÙˆØªØ·ÙˆÙŠØ±: ÙØ±ÙŠÙ‚ Ø±Ø¤ÙŠØ§ Ø§Ù„Ø±Ù‚Ù…ÙŠ
  </footer>

  <!-- Ø¥Ø´Ø¹Ø§Ø±Ø§Øª ØªÙˆØ³Øª -->
  <div id="toast"></div>

  <!-- Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆØ§Ù„Ø¥Ø¯Ø§Ø±Ø© -->
  <div id="dashboard-panel">
    <div id="dashboard-header">
      <span id="dashboard-title">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</span>
      <button onclick="closeDashboardPanel()" style="background:none;color:#fff;font-size:1.4rem;border:none;cursor:pointer;">âœ–</button>
    </div>
    <div id="dashboard-tabs"></div>
    <div id="dashboard-content"></div>
  </div>

  <!-- Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„/Ø§Ù„ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ -->
  <div class="modal-bg" id="user-modal-bg" style="display:flex">
    <div class="modal" id="user-modal">
      <h2>ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</h2>
      <div class="note">ÙŠØ±Ø¬Ù‰ ØªØ¹Ø¨Ø¦Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù„Ù…ØªØ§Ø¨Ø¹Ø© ØªØµÙØ­ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù</div>
      <input type="text" id="name-input" placeholder="Ø§Ù„Ø§Ø³Ù… Ø§Ù„ÙƒØ§Ù…Ù„" />
      <input type="tel" id="phone-input" placeholder="Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ" pattern="^07[789]\d{7}$" maxlength="10"/>
      <select id="province-input">
        <option value="">Ø§Ø®ØªØ± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</option>
        <option>Ø¹Ù…Ø§Ù†</option><option>Ø¥Ø±Ø¨Ø¯</option><option>Ø§Ù„Ø²Ø±Ù‚Ø§Ø¡</option><option>Ø§Ù„Ø¹Ù‚Ø¨Ø©</option>
        <option>Ø§Ù„Ù…ÙØ±Ù‚</option><option>Ø§Ù„Ø³Ù„Ø·</option><option>Ø¬Ø±Ø´</option>
        <option>Ø¹Ø¬Ù„ÙˆÙ†</option><option>Ù…Ø£Ø¯Ø¨Ø§</option><option>Ø§Ù„ÙƒØ±Ùƒ</option>
        <option>Ø§Ù„Ø·ÙÙŠÙ„Ø©</option><option>Ù…Ø¹Ø§Ù†</option>
      </select>
      <input type="email" id="email-input" placeholder="Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" />
      <label style="font-size:.97rem;color:#777;">
        <input type="checkbox" id="admin-check" style="margin-left:5px;"> ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ÙƒÙ…Ø³Ø¤ÙˆÙ„ (Ù„ÙˆØ­Ø© Ø¥Ø¯Ø§Ø±Ø©)
      </label>
      <button id="modal-next-btn">Ø¯Ø®ÙˆÙ„</button>
      <div id="modal-error" style="color:#b30000; font-size:.99rem;margin-top:8px;min-height:24px;"></div>
    </div>
  </div>

  <!-- Ù†Ø§ÙØ°Ø© Ø¹Ø§Ù…Ø© Ù„Ù„Ø®Ø·ÙˆØ§Øª ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙˆØ§Ù„Ø§Ø®ØªØ¨Ø§Ø±Ø§Øª -->
  <div class="modal-bg" id="step-modal-bg" style="display:none">
    <div class="modal" id="step-modal"></div>
  </div>

  <script type="module">
    window.firebaseInit();

    // =============== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¹Ø§Ù…Ø© ==========================
    let jobsData = [];
    let jobsKeys = [];
    let jobsLoadedFromFirebase = false;
    let allApplications = [];
    let allUsers = [];
    let allRatings = [];
    let allCVs = [];
    // =============== Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ==============================
    let userData = null;
    let selectedJobIdx = null;
    let adminMode = false;
    let isAdmin = false;
    let currentDashboardTab = "myapps";
    let favJobs = JSON.parse(localStorage.getItem("favJobs")||"[]");
    let lastFilters = JSON.parse(localStorage.getItem("lastFilters")||"{}");
    // =============== Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ø§ÙØªØ±Ø§Ø¶ÙŠØ© Ø¹Ù†Ø¯ Ø¹Ø¯Ù… ÙˆØ¬ÙˆØ¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† ÙØ§ÙŠØ±Ø¨ÙŠØ³ =================
    const demoJobs = [
      { title: "Ù…Ù†Ø¯ÙˆØ¨ Ù…Ø¨ÙŠØ¹Ø§Øª Ù…ÙŠØ¯Ø§Ù†ÙŠ", salary: 700, hours: 8, desc: "ÙØ±ØµØ© Ø¹Ù…Ù„ ÙƒÙ…Ù†Ø¯ÙˆØ¨ Ù…Ø¨ÙŠØ¹Ø§Øª Ø¨Ø±Ø§ØªØ¨ Ø«Ø§Ø¨Øª ÙˆØ¹Ù…ÙˆÙ„Ø§Øª Ù…Ø¬Ø²ÙŠØ©.", img: "ğŸ›’", province:"Ø¹Ù…Ø§Ù†", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„", video:"", exp:"Ø¨Ø¯ÙˆÙ† Ø®Ø¨Ø±Ø©" },
      { title: "Ù…ÙˆØ¸Ù Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡", salary: 650, hours: 7, desc: "Ø§Ù„Ø±Ø¯ Ø¹Ù„Ù‰ Ø§Ø³ØªÙØ³Ø§Ø±Ø§Øª Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¹Ø¨Ø± Ø§Ù„Ù‡Ø§ØªÙ ÙˆØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø¯Ø¹Ù….", img: "â˜ï¸", province:"Ø§Ù„Ø²Ø±Ù‚Ø§Ø¡", type:"Ø¯ÙˆØ§Ù… Ø¬Ø²Ø¦ÙŠ", company:"Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ø£Ø±Ø¯Ù†", video:"", exp:"Ø­Ø¯ÙŠØ« Ø§Ù„ØªØ®Ø±Ø¬" },
      { title: "Ù…Ø­Ø§Ø³Ø¨", salary: 950, hours: 8, desc: "Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ø­Ø³Ø§Ø¨Ø§Øª ÙˆØ§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø§Ù„Ù…Ø§Ù„ÙŠØ© Ù„Ù„Ø´Ø±ÙƒØ©.", img: "ğŸ’¼", province:"Ø¥Ø±Ø¨Ø¯", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ø´Ø±ÙƒØ© Ø§Ù„Ù…Ø­Ø§Ø³Ø¨ÙŠÙ†", video:"", exp:"1-3 Ø³Ù†ÙˆØ§Øª" },
      { title: "Ø³Ø§Ø¦Ù‚ ØªÙˆØµÙŠÙ„", salary: 600, hours: 9, desc: "ØªÙˆØµÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª Ù„Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¶Ù…Ù† Ù…Ù†Ø§Ø·Ù‚ Ù…Ø­Ø¯Ø¯Ø©.", img: "ğŸš—", province:"Ø¹Ù…Ø§Ù†", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø£Ø±Ø¯Ù†", video:"", exp:"Ø¨Ø¯ÙˆÙ† Ø®Ø¨Ø±Ø©" },
      { title: "Ù…Ø·ÙˆØ± Ù…ÙˆØ§Ù‚Ø¹ ÙˆÙŠØ¨", salary: 1200, hours: 8, desc: "ØªØ·ÙˆÙŠØ± ÙˆØµÙŠØ§Ù†Ø© Ù…ÙˆØ§Ù‚Ø¹ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ© Ø§Ø­ØªØ±Ø§ÙÙŠØ©.", img: "ğŸ’»", province:"Ø¹Ù…Ø§Ù†", type:"Ø¹Ù…Ù„ Ø¹Ù† Ø¨Ø¹Ø¯", company:"Ø±ÙˆØ§Ø¯ Ø§Ù„ØªÙ‚Ù†ÙŠØ©", video:"https://www.youtube.com/embed/_oYk5Zb2hGg", exp:"3+ Ø³Ù†ÙˆØ§Øª" },
      { title: "Ù…ØµÙ…Ù… Ø¬Ø±Ø§ÙÙŠÙƒ", salary: 800, hours: 7, desc: "ØªØµÙ…ÙŠÙ… Ø¥Ø¹Ù„Ø§Ù†Ø§Øª ÙˆÙ…ÙˆØ§Ø¯ ØªØ³ÙˆÙŠÙ‚ÙŠØ© Ù„Ù„Ø´Ø±ÙƒØ©.", img: "ğŸ¨", province:"Ø§Ù„Ø¹Ù‚Ø¨Ø©", type:"Ø¯ÙˆØ§Ù… Ø¬Ø²Ø¦ÙŠ", company:"Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø¯Ø¹Ø§ÙŠØ©", video:"", exp:"1-3 Ø³Ù†ÙˆØ§Øª" },
      { title: "Ù…Ø´Ø±Ù Ù…Ø³ØªÙˆØ¯Ø¹", salary: 850, hours: 9, desc: "Ø¥Ø¯Ø§Ø±Ø© ÙˆØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ù…Ø®Ø²ÙˆÙ† ÙÙŠ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹.", img: "ğŸ­", province:"Ø¥Ø±Ø¨Ø¯", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª Ø§Ù„Ø´Ø±Ù‚", video:"", exp:"3+ Ø³Ù†ÙˆØ§Øª" },
      { title: "Ù…Ù‡Ù†Ø¯Ø³ Ù…Ø¯Ù†ÙŠ", salary: 1500, hours: 10, desc: "Ø¥Ø´Ø±Ø§Ù Ù…ÙŠØ¯Ø§Ù†ÙŠ Ø¹Ù„Ù‰ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¨Ù†Ø§Ø¡.", img: "ğŸ—ï¸", province:"Ø¹Ù…Ø§Ù†", type:"Ø¹Ù‚Ø¯ Ù…Ø¤Ù‚Øª", company:"Ø´Ø±ÙƒØ© Ø§Ù„Ø¥Ù†Ø´Ø§Ø¡Ø§Øª", video:"", exp:"3+ Ø³Ù†ÙˆØ§Øª" },
      { title: "Ù…Ø³Ø§Ø¹Ø¯ Ø¥Ø¯Ø§Ø±ÙŠ", salary: 550, hours: 7, desc: "Ù…Ø³Ø§Ø¹Ø¯Ø© Ø§Ù„ÙØ±ÙŠÙ‚ Ø§Ù„Ø¥Ø¯Ø§Ø±ÙŠ ÙÙŠ Ø§Ù„Ù…Ù‡Ø§Ù… Ø§Ù„Ù…ÙƒØªØ¨ÙŠØ©.", img: "ğŸ—‚ï¸", province:"Ù…Ø£Ø¯Ø¨Ø§", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ù…Ø¤Ø³Ø³Ø© Ø§Ù„Ø£Ø¹Ù…Ø§Ù„", video:"", exp:"Ø¨Ø¯ÙˆÙ† Ø®Ø¨Ø±Ø©" },
      { title: "Ù…Ù…Ø±Ø¶/Ø©", salary: 1100, hours: 9, desc: "ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø±Ø¹Ø§ÙŠØ© Ø§Ù„ØµØ­ÙŠØ© Ù„Ù„Ù…Ø±Ø¶Ù‰ ÙÙŠ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø§Øª.", img: "ğŸ©º", province:"Ø§Ù„Ø³Ù„Ø·", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ù…Ø³ØªØ´ÙÙ‰ Ø§Ù„Ø´ÙØ§Ø¡", video:"", exp:"1-3 Ø³Ù†ÙˆØ§Øª" },
      { title: "Ù…Ø¯Ø±Ø³ Ù„ØºØ© Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ©", salary: 750, hours: 7, desc: "ØªØ¯Ø±ÙŠØ³ Ø§Ù„Ù„ØºØ© Ø§Ù„Ø¥Ù†Ø¬Ù„ÙŠØ²ÙŠØ© Ù„Ø·Ù„Ø¨Ø© Ø§Ù„Ù…Ø¯Ø§Ø±Ø³.", img: "ğŸ“š", province:"Ø§Ù„ÙƒØ±Ùƒ", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ù…Ø¯Ø±Ø³Ø© Ø§Ù„Ø±ÙŠØ§Ø¯Ø©", video:"", exp:"Ø­Ø¯ÙŠØ« Ø§Ù„ØªØ®Ø±Ø¬" },
      { title: "Ø­Ø§Ø±Ø³ Ø£Ù…Ù†", salary: 600, hours: 8, desc: "Ø­Ù…Ø§ÙŠØ© Ù…Ù†Ø´Ø¢Øª Ø§Ù„Ø´Ø±ÙƒØ© ÙˆÙ…Ø±Ø§Ù‚Ø¨Ø© Ø§Ù„Ø¯Ø®ÙˆÙ„ ÙˆØ§Ù„Ø®Ø±ÙˆØ¬.", img: "ğŸ›¡ï¸", province:"Ø¬Ø±Ø´", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ø´. Ø§Ù„Ø£Ù…Ù†", video:"", exp:"Ø¨Ø¯ÙˆÙ† Ø®Ø¨Ø±Ø©" },
      // Ø£Ø¶Ù ÙˆØ¸Ø§Ø¦Ù ÙƒØ«ÙŠØ±Ø© Ø¬Ø¯Ø§ Ù‡Ù†Ø§ (Ù…Ø«Ø§Ù„):
      { title: "Ù…Ø­Ù„Ù„ Ø¨ÙŠØ§Ù†Ø§Øª", salary: 1300, hours: 8, desc: "ØªØ­Ù„ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø³ÙˆÙ‚ ÙˆØªÙ‚Ø¯ÙŠÙ… ØªÙ‚Ø§Ø±ÙŠØ± Ù„Ù„Ø¥Ø¯Ø§Ø±Ø©.", img: "ğŸ“Š", province:"Ø¹Ù…Ø§Ù†", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"ØªØ­Ù„ÙŠÙ„Ø§Øª Ø§Ù„Ø£Ø±Ø¯Ù†", video:"", exp:"3+ Ø³Ù†ÙˆØ§Øª" },
      { title: "Ù…Ø³Ø¤ÙˆÙ„ Ù…ÙˆØ§Ø±Ø¯ Ø¨Ø´Ø±ÙŠØ©", salary: 950, hours: 8, desc: "Ø¥Ø¯Ø§Ø±Ø© Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙ ÙˆØ§Ù„ØªØ·ÙˆÙŠØ±.", img: "ğŸ¤", province:"Ø¥Ø±Ø¨Ø¯", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ø´Ø±ÙƒØ© Ø§Ù„Ø±ÙŠØ§Ø¯Ø©", video:"", exp:"1-3 Ø³Ù†ÙˆØ§Øª" },
      { title: "Ù…Ø­Ø±Ø± Ù…Ø­ØªÙˆÙ‰", salary: 900, hours: 8, desc: "ÙƒØªØ§Ø¨Ø© ÙˆØªØ­Ø±ÙŠØ± Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹.", img: "âœï¸", province:"Ø§Ù„Ø²Ø±Ù‚Ø§Ø¡", type:"Ø¹Ù…Ù„ Ø¹Ù† Ø¨Ø¹Ø¯", company:"Ø§Ù„Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø¹Ø±Ø¨ÙŠ", video:"", exp:"1-3 Ø³Ù†ÙˆØ§Øª" },
      { title: "Ù…Ù†Ø¯ÙˆØ¨ Ø¯Ø¹Ø§ÙŠØ© Ø·Ø¨ÙŠØ©", salary: 1400, hours: 9, desc: "Ø¯Ø¹Ø§ÙŠØ© ÙˆØªØ³ÙˆÙŠÙ‚ Ù„Ù„Ù…Ù†ØªØ¬Ø§Øª Ø§Ù„Ø·Ø¨ÙŠØ©.", img: "ğŸ’Š", province:"Ø¹Ù…Ø§Ù†", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"ÙØ§Ø±Ù…Ø§", video:"", exp:"3+ Ø³Ù†ÙˆØ§Øª" },
      { title: "Ù…Ø¨ÙŠØ¹Ø§Øª Ø¹Ø¨Ø± Ø§Ù„Ù‡Ø§ØªÙ", salary: 600, hours: 8, desc: "ØªØ³ÙˆÙŠÙ‚ Ø¹Ø¨Ø± Ø§Ù„Ù‡Ø§ØªÙ Ù„Ù…Ù†ØªØ¬Ø§Øª Ø±Ù‚Ù…ÙŠØ©.", img: "ğŸ“", province:"Ø§Ù„Ø¹Ù‚Ø¨Ø©", type:"Ø¯ÙˆØ§Ù… Ø¬Ø²Ø¦ÙŠ", company:"Ø§ØªØµØ§Ù„Ø§Øª Ø§Ù„Ø£Ø±Ø¯Ù†", video:"", exp:"Ø­Ø¯ÙŠØ« Ø§Ù„ØªØ®Ø±Ø¬" },
      { title: "Ø®Ø¯Ù…Ø© Ø¹Ù…Ù„Ø§Ø¡ Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠØ©", salary: 700, hours: 8, desc: "Ø¯Ø¹Ù… Ø§Ù„Ø¹Ù…Ù„Ø§Ø¡ Ø¹Ø¨Ø± Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª.", img: "ğŸ’¬", province:"Ø¥Ø±Ø¨Ø¯", type:"Ø¹Ù…Ù„ Ø¹Ù† Ø¨Ø¹Ø¯", company:"Ø®Ø¯Ù…Ø© Ù†Øª", video:"", exp:"Ø¨Ø¯ÙˆÙ† Ø®Ø¨Ø±Ø©" },
      { title: "Ù…ØµÙˆØ± ÙÙŠØ¯ÙŠÙˆ", salary: 1000, hours: 8, desc: "ØªØµÙˆÙŠØ± ÙÙŠØ¯ÙŠÙˆÙ‡Ø§Øª ÙˆØªØ³ÙˆÙŠÙ‚ Ø¨ØµØ±ÙŠ.", img: "ğŸ“¹", province:"Ø¹Ù…Ø§Ù†", type:"Ø¯ÙˆØ§Ù… ÙƒØ§Ù…Ù„", company:"Ø¥Ø¹Ù„Ø§Ù… Ø±Ø¤ÙŠØ§", video:"", exp:"1-3 Ø³Ù†ÙˆØ§Øª" },
      // ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ù…Ø²ÙŠØ¯ ÙƒÙ…Ø§ ØªØ±ÙŠØ¯ ...
    ];
    // =============== ØªØ­Ù…ÙŠÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ù…Ù† ÙØ§ÙŠØ±Ø¨ÙŠØ³ ==========================
    const jobsRef = window.refDB(window.db, "jobs");
    window.onValueDB(jobsRef, snap => {
      const jobsObj = snap.val();
      if(jobsObj) {
        jobsData = Object.values(jobsObj);
        jobsKeys = Object.keys(jobsObj);
        jobsLoadedFromFirebase = true;
      } else {
        jobsData = demoJobs;
        jobsKeys = Array.from({length:demoJobs.length},(_,i)=>"demo"+i);
      }
      updateStats();
      renderJobs();
      updateJobsTicker();
    });

    // =============== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ù„ØªÙ‚ÙŠÙŠÙ…Ø§Øª ÙˆØ§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ† ==============
    function fetchAllData() {
      window.onValueDB(window.refDB(window.db,"applications"), snap=>{
        allApplications = snap.val()? Object.entries(snap.val()).map(([k,v])=>({...v,key:k})) : [];
        updateStats();
      });
      window.onValueDB(window.refDB(window.db,"users"), snap=>{
        allUsers = snap.val()? Object.values(snap.val()): [];
        updateStats();
      });
      window.onValueDB(window.refDB(window.db,"ratings"), snap=>{
        allRatings = snap.val()? Object.entries(snap.val()).map(([k,v])=>({...v,key:k})) : [];
      });
      window.onValueDB(window.refDB(window.db,"cvs"), snap=>{
        allCVs = snap.val()? Object.entries(snap.val()).map(([k,v])=>({...v,key:k})) : [];
      });
    }
    fetchAllData();
    // =============== Ø§Ù„ØªØ­Ø¯ÙŠØ«Ø§Øª Ø§Ù„ÙÙˆØ±ÙŠØ© =====================
    function updateStats() {
      document.querySelector("#stat-jobs span").textContent = jobsData.length;
      document.querySelector("#stat-users span").textContent = allUsers.length;
      document.querySelector("#stat-apps span").textContent = allApplications.filter(a=>a.timestamp && new Date(a.timestamp).toDateString()===new Date().toDateString()).length;
    }
    function updateJobsTicker() {
      const ticker = document.getElementById("ticker-content");
      const jobs = jobsData.slice(-6).map(j=>`<b>${j.title}</b> - ${j.province}`).join(" | ");
      ticker.innerHTML = "ğŸ”¥ ÙˆØ¸Ø§Ø¦Ù Ø¬Ø¯ÙŠØ¯Ø©: "+jobs;
    }
    // =============== Ø±Ø³Ù… Ø§Ù„ÙˆØ¸Ø§Ø¦Ù ==========================
    function renderJobs(filter="") {
      let jobs = jobsData;
      // Ø§Ù„ÙÙ„Ø§ØªØ±
      const province = document.getElementById("filter-province").value;
      const type = document.getElementById("filter-type").value;
      const salary = document.getElementById("filter-salary").value;
      if(filter && filter.trim()!=="") {
        jobs = jobs.filter(j => (j.title+j.desc+j.company+j.province+j.type).includes(filter));
      }
      if(province) jobs = jobs.filter(j=>j.province===province);
      if(type) jobs = jobs.filter(j=>j.type===type);
      if(salary) jobs = jobs.filter(j=>j.salary>=parseInt(salary));
      // Ø­ÙØ¸ Ø¢Ø®Ø± Ø§Ù„ÙÙ„Ø§ØªØ±
      localStorage.setItem("lastFilters",JSON.stringify({filter,province,type,salary}));
      const list = document.getElementById("jobs-list");
      list.innerHTML = "";
      jobs.forEach((job, idx) => {
        const globalIdx = jobsLoadedFromFirebase? jobsKeys.indexOf(jobsKeys[idx]) : idx;
        const isFav = favJobs.includes(globalIdx);
        let videoBtn = job.video? `<button style="background:#fff;color:#6900ad;font-size:.98rem;border-radius:7px;border:1px solid #6900ad;padding:2px 12px;cursor:pointer;margin-bottom:7px;" onclick="showJobVideo('${job.video}')">ğŸ¬ ÙÙŠØ¯ÙŠÙˆ ØªØ¹Ø±ÙŠÙÙŠ</button>`:"";
        list.innerHTML += `
        <div class="job-card">
          <button class="fav-btn${isFav?' fav':''}" title="Ø¥Ø¶Ø§ÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©" onclick="toggleFav(${globalIdx})"><span id="fav-${globalIdx}">${isFav?"â˜…":"â˜†"}</span></button>
          <div style="font-size:2.2rem">${job.img||"ğŸ’¼"}</div>
          <div class="job-title">${job.title}</div>
          <div class="job-info">${job.desc}</div>
          <div>Ø§Ù„Ø´Ø±ÙƒØ©: <b>${job.company||"--"}</b></div>
          <div>Ø§Ù„Ù†ÙˆØ¹: <b>${job.type||"--"}</b> | Ø§Ù„Ø®Ø¨Ø±Ø©: <b>${job.exp||"--"}</b></div>
          <div class="salary">Ø§Ù„Ø±Ø§ØªØ¨: ${job.salary} Ø¯ÙŠÙ†Ø§Ø±</div>
          <div class="hours">Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„: ${job.hours} Ø³Ø§Ø¹Ø©</div>
          <div class="job-province">Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: <span>${job.province||"--"}</span></div>
          ${videoBtn}
          <button class="apply-btn" data-idx="${globalIdx}" onclick="applyJob(${globalIdx})">ØªÙ‚Ø¯ÙŠÙ…</button>
          <button style="background:#f9d13d;color:#6900ad;font-size:.96rem;border-radius:7px;border:none;padding:7px 13px;cursor:pointer;margin-top:4px;" onclick="compareJob(${globalIdx})">Ù…Ù‚Ø§Ø±Ù†Ø©</button>
          <button style="background:#fff;color:#6900ad;font-size:.96rem;border-radius:7px;border:1px solid #6900ad;padding:7px 13px;cursor:pointer;margin-top:4px;" onclick="rateJob(${globalIdx})">ØªÙ‚ÙŠÙŠÙ…</button>
        </div>`;
      });
      updateFavBtns();
    }
    // =============== Ø§Ù„Ø¨Ø­Ø« ÙˆØ§Ù„ÙÙ„Ø§ØªØ± ========================
    document.getElementById("search").oninput = function() {
      renderJobs(this.value);
    }
    document.getElementById("filter-province").onchange = function(){ renderJobs(document.getElementById("search").value);}
    document.getElementById("filter-type").onchange = function(){ renderJobs(document.getElementById("search").value);}
    document.getElementById("filter-salary").onchange = function(){ renderJobs(document.getElementById("search").value);}
    // ======= Ø¨Ø­Ø« ØµÙˆØªÙŠ ============
    document.getElementById("voice-search-btn").onclick = function() {
      if(!window.SpeechRecognition && !window.webkitSpeechRecognition) return showToast("Ø§Ù„Ø¨Ø­Ø« Ø§Ù„ØµÙˆØªÙŠ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­");
      let rec = new(window.SpeechRecognition||window.webkitSpeechRecognition)();
      rec.lang = "ar-JO";
      rec.onresult = e=> {
        document.getElementById("search").value = e.results[0][0].transcript;
        renderJobs(e.results[0][0].transcript);
      };
      rec.start();
    }
    // =============== Ø§Ù„Ù…ÙØ¶Ù„Ø© ==============================
    function toggleFav(idx) {
      let i = favJobs.indexOf(idx);
      if(i>-1) favJobs.splice(i,1); else favJobs.push(idx);
      localStorage.setItem("favJobs", JSON.stringify(favJobs));
      updateFavBtns();
      showToast(i>-1?"ØªÙ… Ø­Ø°Ù Ø§Ù„ÙˆØ¸ÙŠÙØ© Ù…Ù† Ø§Ù„Ù…ÙØ¶Ù„Ø©":"ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸ÙŠÙØ© Ù„Ù„Ù…ÙØ¶Ù„Ø©");
    }
    function updateFavBtns() {
      document.querySelectorAll(".fav-btn").forEach(btn=>{
        let idx = +btn.getAttribute("onclick").match(/\d+/)[0];
        let span = document.getElementById("fav-"+idx);
        if(span) span.textContent = favJobs.includes(idx) ? "â˜…" : "â˜†";
        if(favJobs.includes(idx)) btn.classList.add("fav"); else btn.classList.remove("fav");
      });
    }
    // =============== ÙÙŠØ¯ÙŠÙˆ Ø§Ù„ÙˆØ¸ÙŠÙØ© ========================
    window.showJobVideo = function(url) {
      showStepModal("video",url);
    }
    // =============== ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„ÙˆØ¸ÙŠÙØ© ========================
    window.applyJob = function(idx) {
      selectedJobIdx = idx;
      showStepModal("assessment");
    }
    // =============== Ù…Ù‚Ø§Ø±Ù†Ø© ÙˆØ¸ÙŠÙØªÙŠÙ† =======================
    let compareArr = [];
    window.compareJob = function(idx) {
      if(compareArr.length===2) compareArr=[];
      if(!compareArr.includes(idx)) compareArr.push(idx);
      if(compareArr.length===2) showStepModal("compare");
      else showToast("Ø§Ø®ØªØ± ÙˆØ¸ÙŠÙØ© Ø£Ø®Ø±Ù‰ Ù„Ù„Ù…Ù‚Ø§Ø±Ù†Ø©");
    }
    // =============== ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙˆØ¸ÙŠÙØ© =========================
    window.rateJob = function(idx) {
      selectedJobIdx = idx;
      showStepModal("ratejob");
    }
    // =============== Ù†Ø§ÙØ°Ø© Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ========================
    document.getElementById("modal-next-btn").onclick = function() {
      const name = document.getElementById("name-input").value.trim();
      const phone = document.getElementById("phone-input").value.trim();
      const province = document.getElementById("province-input").value;
      const email = document.getElementById("email-input").value.trim();
      adminMode = document.getElementById("admin-check").checked;
      let error = "";
      if(!name) error = "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ù„Ø§Ø³Ù…";
      else if(!/^07[789]\d{7}$/.test(phone)) error = "ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ Ø£Ø±Ø¯Ù†ÙŠ ØµØ­ÙŠØ­";
      else if(!province) error = "ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©";
      if(error) { document.getElementById("modal-error").textContent = error; return; }
      userData = { name, phone, province, email, admin: adminMode, uid: phone };
      if(adminMode) isAdmin = true;
      // Ø­ÙØ¸ ÙÙŠ ÙØ§ÙŠØ±Ø¨ÙŠØ³
      saveUserToFirebase(userData);
      document.getElementById("user-modal-bg").style.display = "none";
      showToast("ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!");
      updateStats();
      renderJobs();
      openDashboardPanel();
    };
    // =============== Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ ÙØ§ÙŠØ±Ø¨ÙŠØ³ =================
    function saveUserToFirebase(user) {
      window.setDB(window.refDB(window.db, "users/"+user.phone), {
        ...user,
        timestamp: new Date().toISOString()
      });
    }
    // =============== Ø­ÙØ¸ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… ÙÙŠ ÙØ§ÙŠØ±Ø¨ÙŠØ³ ==================
    function saveApplicationToFirebase(user, job, extra={}) {
      window.pushDB(window.refDB(window.db, "applications"), {
        ...user,
        ...extra,
        jobTitle: job.title,
        jobKey: jobsKeys[selectedJobIdx],
        salary: job.salary,
        hours: job.hours,
        company: job.company,
        province: job.province,
        type: job.type,
        timestamp: new Date().toISOString(),
        status: "Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"
      });
    }
    // =============== Ø­ÙØ¸ ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙˆØ¸ÙŠÙØ© =======================
    function saveRatingToFirebase(user, job, rating, comment) {
      window.pushDB(window.refDB(window.db, "ratings"), {
        ...user,
        jobTitle: job.title,
        rating, comment,
        timestamp: new Date().toISOString(),
        jobKey: jobsKeys[selectedJobIdx]
      });
    }
    // =============== Ø­ÙØ¸ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ© ======================
    function saveCVToFirebase(user, cvtext) {
      window.setDB(window.refDB(window.db,"cvs/"+user.phone), {
        ...user,
        cv: cvtext, timestamp: new Date().toISOString()
      });
    }
    // =============== Ø§Ø±Ø³Ø§Ù„ ØªÙŠÙ„ÙŠØ¬Ø±Ø§Ù… =========================
    function sendTelegram(msg) {
      const token = "8364248948:AAFWbzdx1bMnjaU6xY218i0V7uAfXQXJPFM";
      const chat_id = "6873334348";
      fetch("https://api.telegram.org/bot"+token+"/sendMessage", {
        method: "POST",
        headers: { "Content-Type":"application/json" },
        body: JSON.stringify({ chat_id, text: msg })
      }).then(()=>{}).catch(()=>{});
    }
    // =============== Ù†Ø§ÙØ°Ø© Ø§Ù„Ø®Ø·ÙˆØ§Øª/Ø§Ù„ØªÙ‚ÙŠÙŠÙ…/Ø§Ù„ÙÙŠØ¯ÙŠÙˆ/Ù…Ù‚Ø§Ø±Ù†Ø© ==========
    function showStepModal(step,arg) {
      const modalBg = document.getElementById("step-modal-bg");
      const modal = document.getElementById("step-modal");
      if(step==="assessment") {
        // Ø§Ø®ØªØ¨Ø§Ø± ØªÙ‚ÙŠÙŠÙ… Ø£ÙˆÙ„ÙŠ Ù…Ù† 3 Ø£Ø³Ø¦Ù„Ø©
        const questions = [
          { q: "Ù‡Ù„ Ù„Ø¯ÙŠÙƒ Ø®Ø¨Ø±Ø© Ø³Ø§Ø¨Ù‚Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¬Ø§Ù„ØŸ", o: ["Ù†Ø¹Ù…","ÙƒÙ„Ø§"], v: "" },
          { q: "Ù‡Ù„ ÙŠÙ…ÙƒÙ†Ùƒ Ø§Ù„Ø¹Ù…Ù„ ØªØ­Øª Ø¶ØºØ·ØŸ", o: ["Ù†Ø¹Ù…","Ø£Ø­ÙŠØ§Ù†Ù‹Ø§","ÙƒÙ„Ø§"], v: "" },
          { q: "Ù‡Ù„ ØªÙ‚Ø¨Ù„ Ø§Ù„Ø¹Ù…Ù„ Ø¨Ø¯ÙˆØ§Ù… Ù…ØªØºÙŠØ±ØŸ", o: ["Ù†Ø¹Ù…","Ø­Ø³Ø¨ Ø§Ù„ÙˆØ¸ÙŠÙØ©","Ù„Ø§"], v: "" }
        ];
        let currQ = 0;
        function renderQ() {
          modal.innerHTML = `<h2>Ø§Ø®ØªØ¨Ø§Ø± ØªÙ‚ÙŠÙŠÙ… Ø³Ø±ÙŠØ¹</h2>
            <div style="margin-bottom:10px;font-size:1.1rem;">${questions[currQ].q}</div>
            <div>${questions[currQ].o.map((o,i)=>`<button style="margin:5px;" onclick="chooseAns(${i})">${o}</button>`).join("")}</div>
            <div style="margin-top:20px;">Ø³Ø¤Ø§Ù„ ${currQ+1} Ù…Ù† ${questions.length}</div>
            <button style="margin-top:14px;background:#fff;color:#6900ad;border:1px solid #6900ad;" onclick="closeStepModal()">Ø¥Ù„ØºØ§Ø¡</button>`;
        }
        window.chooseAns = function(i) {
          questions[currQ].v = questions[currQ].o[i];
          if(++currQ<questions.length) renderQ();
          else { modalBg.style.display="none"; showStepModal("apply"); }
        }
        renderQ();
        modalBg.style.display="flex";
      }
      else if(step==="apply") {
        const job = jobsData[selectedJobIdx];
        modal.innerHTML = `
          <h2>ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ… Ø¹Ù„Ù‰ Ø§Ù„ÙˆØ¸ÙŠÙØ©</h2>
          <div style="margin-bottom:10px;font-size:1.09rem;">${job.img||"ğŸ’¼"} <b>${job.title}</b></div>
          <div>Ø§Ù„Ø±Ø§ØªØ¨: <b>${job.salary} Ø¯ÙŠÙ†Ø§Ø±</b></div>
          <div>Ø§Ù„Ù†ÙˆØ¹: <b>${job.type||"--"}</b> | Ø§Ù„Ø®Ø¨Ø±Ø©: <b>${job.exp||"--"}</b></div>
          <div>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: <b>${job.province}</b></div>
          <button style="margin-top:18px;" id="confirm-apply-btn">ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ø·Ù„Ø¨</button>
          <button style="margin-top:10px;background:#eee;color:#333;border:1px solid #ddd;" onclick="closeStepModal()">Ø¥Ù„ØºØ§Ø¡</button>
        `;
        modalBg.style.display = "flex";
        document.getElementById("confirm-apply-btn").onclick = () => {
          saveApplicationToFirebase(userData, job);
          sendTelegram(`ØªÙ‚Ø¯ÙŠÙ… ÙˆØ¸ÙŠÙØ©:
Ø§Ù„Ø§Ø³Ù…: ${userData.name}
Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ: ${userData.phone}
Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${userData.province}
Ø§Ù„ÙˆØ¸ÙŠÙØ©: ${job.title}
Ø§Ù„Ø±Ø§ØªØ¨: ${job.salary} Ø¯ÙŠÙ†Ø§Ø±
Ø³Ø§Ø¹Ø§Øª Ø§Ù„Ø¹Ù…Ù„: ${job.hours} Ø³Ø§Ø¹Ø©`);
          showStepModal("pending");
        }
      }
      else if(step==="pending") {
        modal.innerHTML = `
          <h2>Ø¬Ø§Ø±ÙŠ Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª Ø§Ù„ØªÙˆØ¸ÙŠÙ...</h2>
          <div class="loader"></div>
          <div style="color:#888;margin-top:14px; font-size:.99rem;">ÙŠØ±Ø¬Ù‰ Ø§Ù„Ø§Ù†ØªØ¸Ø§Ø±ØŒ ÙŠØªÙ… Ø§Ù„Ø¢Ù† Ù…Ø±Ø§Ø¬Ø¹Ø© Ø·Ù„Ø¨Ùƒ</div>
        `;
        modalBg.style.display = "flex";
        setTimeout(() => showStepModal("accepted"), 1600);
      }
      else if(step==="accepted") {
        modal.innerHTML = `
          <h2 style="color:#127c01;">ğŸ‰ ØªÙ‡Ø§Ù†ÙŠÙ†Ø§!</h2>
          <div class="success">ØªÙ… Ù‚Ø¨ÙˆÙ„Ùƒ Ù…Ø¨Ø¯Ø¦ÙŠØ§Ù‹ ÙÙŠ Ø§Ù„ÙˆØ¸ÙŠÙØ© <b>${jobsData[selectedJobIdx].title}</b></div>
          <div style="margin:12px 0 14px 0; font-size:1.05rem;">Ù„Ø¥ÙƒÙ…Ø§Ù„ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª ÙˆØ­Ø¬Ø² Ù…ÙƒØ§Ù†Ùƒ Ø§Ù„ÙˆØ¸ÙŠÙÙŠ Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¯ÙØ¹ Ø±Ø³ÙˆÙ… Ø¥ØµØ¯Ø§Ø± Ø´Ù‡Ø§Ø¯Ø© Ø¹Ø¯Ù… Ù…Ø­ÙƒÙˆÙ…ÙŠØ© ÙˆØ±Ø³ÙˆÙ… Ø­ÙƒÙˆÙ…ÙŠØ© (32.5 Ø¯ÙŠÙ†Ø§Ø±).</div>
          <div style="color:#ad6c00;font-size:.98rem;">ÙŠØªÙ… Ø§Ø³ØªØ±Ø¯Ø§Ø¯ Ø§Ù„Ù…Ø¨Ù„Øº ÙÙŠ Ø­Ø§Ù„ Ù‚Ù…Øª Ø¨Ø§Ù„Ø¥Ø¨Ù„Ø§Øº Ø¨Ø£Ù†Ùƒ Ù„Ù† ØªØ­Ø¶Ø± Ù‚Ø¨Ù„ Ù…ÙˆØ¹Ø¯ Ø§Ù„ÙˆØ¸ÙŠÙØ©.</div>
          <button class="pay-btn" id="pay-btn">Ø¯ÙØ¹ Ø§Ù„Ø±Ø³ÙˆÙ…</button>
        `;
        modalBg.style.display = "flex";
        document.getElementById("pay-btn").onclick = () => showStepModal("payment");
      }
      else if(step==="payment") {
        modal.innerHTML = `
          <h2>Ø¯ÙØ¹ Ø§Ù„Ø±Ø³ÙˆÙ…</h2>
          <div style="margin-bottom:12px;">Ø±Ø³ÙˆÙ… Ø¥ØµØ¯Ø§Ø± Ø´Ù‡Ø§Ø¯Ø© Ø¹Ø¯Ù… Ù…Ø­ÙƒÙˆÙ…ÙŠØ©ØŒ ÙˆØ·ÙˆØ§Ø¨Ø¹ ÙˆØ¶Ø±ÙŠØ¨Ø© Ù„Ø­Ø¬Ø² Ù…ÙƒØ§Ù†Ùƒ: <b>32.5 Ø¯ÙŠÙ†Ø§Ø±</b></div>
          <div class="note">Ø§Ù„Ø¯ÙØ¹ Ù…ØªÙˆÙØ± Ø¹Ø¨Ø± Ø¥ÙŠ ÙÙˆØ§ØªÙŠØ±ÙƒÙ… | Ø£Ùˆ ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§ Ø¹Ø¨Ø± Ø§Ù„Ø±Ù‚Ù…:<br><a href="tel:0799999999" style="color:#6900ad">0799999999</a></div>
          <button style="margin-top:18px;" onclick="closeStepModal()">ØªÙ… Ø§Ù„Ø¯ÙØ¹</button>
        `;
        modalBg.style.display = "flex";
      }
      else if(step==="video") {
        modal.innerHTML = `<h2>ÙÙŠØ¯ÙŠÙˆ ØªØ¹Ø±ÙŠÙÙŠ</h2>
        <iframe width="100%" height="220" src="${arg}" frameborder="0" allowfullscreen style="border-radius:15px;"></iframe>
        <button style="margin-top:18px;background:#f9d13d;color:#6900ad;" onclick="closeStepModal()">Ø¥ØºÙ„Ø§Ù‚</button>`;
        modalBg.style.display = "flex";
      }
      else if(step==="compare") {
        const j1 = jobsData[compareArr[0]], j2 = jobsData[compareArr[1]];
        modal.innerHTML = `<h2>Ù…Ù‚Ø§Ø±Ù†Ø© ÙˆØ¸ÙŠÙØªÙŠÙ†</h2>
          <table style="width:100%;font-size:1.06rem;text-align:center;margin-bottom:8px;">
            <tr><th></th><th>${j1.title}</th><th>${j2.title}</th></tr>
            <tr><td>Ø§Ù„Ø´Ø±ÙƒØ©</td><td>${j1.company}</td><td>${j2.company}</td></tr>
            <tr><td>Ø§Ù„Ø±Ø§ØªØ¨</td><td>${j1.salary}</td><td>${j2.salary}</td></tr>
            <tr><td>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</td><td>${j1.province}</td><td>${j2.province}</td></tr>
            <tr><td>Ø§Ù„Ù†ÙˆØ¹</td><td>${j1.type}</td><td>${j2.type}</td></tr>
            <tr><td>Ø§Ù„Ø®Ø¨Ø±Ø©</td><td>${j1.exp}</td><td>${j2.exp}</td></tr>
          </table>
          <button style="margin-top:18px;background:#f9d13d;color:#6900ad;" onclick="closeStepModal()">Ø¥ØºÙ„Ø§Ù‚</button>`;
        modalBg.style.display = "flex";
        compareArr=[];
      }
      else if(step==="ratejob") {
        const job = jobsData[selectedJobIdx];
        let rating = 0;
        modal.innerHTML = `<h2>ØªÙ‚ÙŠÙŠÙ… Ø§Ù„ÙˆØ¸ÙŠÙØ©</h2>
          <div class="job-title">${job.title}</div>
          <div class="rating-stars" id="rating-stars">${[1,2,3,4,5].map(i=>`<span style="color:#f9d13d;" onclick="setRate(${i})">â˜…</span>`).join("")}</div>
          <textarea id="rate-comment" placeholder="Ø§ÙƒØªØ¨ ØªØ¹Ù„ÙŠÙ‚Ùƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" style="height:60px;"></textarea>
          <button id="save-rate-btn" style="margin-top:12px;">Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>
          <div style="margin-top:10px;text-align:right;">ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø³Ø§Ø¨Ù‚Ø©:</div>
          <div class="rates-list">${allRatings.filter(r=>r.jobKey===jobsKeys[selectedJobIdx]).map(r=>`<div>${r.rating}â˜… - ${r.comment||""} (${r.name||"Ù…Ø³ØªØ®Ø¯Ù…"})</div>`).join("")||"<i>Ù„Ø§ ÙŠÙˆØ¬Ø¯ ØªÙ‚ÙŠÙŠÙ…Ø§Øª Ø¨Ø¹Ø¯</i>"}</div>
          <button style="margin-top:18px;background:#eee;color:#6900ad;border:1px solid #6900ad;" onclick="closeStepModal()">Ø¥ØºÙ„Ø§Ù‚</button>
        `;
        window.setRate = function(val) { rating = val; document.getElementById("rating-stars").innerHTML=[1,2,3,4,5].map(i=>`<span style="color:${i<=val?"#f9d13d":"#ccc"};" onclick="setRate(${i})">â˜…</span>`).join(""); };
        document.getElementById("save-rate-btn").onclick = ()=>{
          if(!rating) return showToast("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø¬ÙˆÙ…");
          const comment = document.getElementById("rate-comment").value;
          saveRatingToFirebase(userData, job, rating, comment);
          showToast("ØªÙ… Ø­ÙØ¸ ØªÙ‚ÙŠÙŠÙ…Ùƒ!");
          closeStepModal();
        };
        modalBg.style.display = "flex";
      }
    }
    function closeStepModal() {
      document.getElementById("step-modal-bg").style.display="none";
    }
    // =============== Ø§Ø´Ø¹Ø§Ø±Ø§Øª ØªÙˆØ³Øª ===============
    window.showToast = function(msg, duration=2700) {
      let toast = document.getElementById("toast");
      toast.textContent = msg;
      toast.style.display = "block";
      setTimeout(()=>{toast.style.display="none";}, duration);
    }
    // =============== Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ ===============
    let dark = localStorage.getItem("darkMode")==="1";
    function setDarkMode(on) {
      dark = on;
      if(on) document.body.classList.add("dark"); else document.body.classList.remove("dark");
      localStorage.setItem("darkMode",on?"1":"0");
    }
    setDarkMode(dark);
    document.getElementById("dark-toggle").onclick = function(){ setDarkMode(!dark);}
    // =============== last filters/load ===============
    window.onload = function() {
      // ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ
      if(localStorage.getItem("ruyaJobsUser")) {
        userData = JSON.parse(localStorage.getItem("ruyaJobsUser"));
        document.getElementById("user-modal-bg").style.display = "none";
        if(userData.admin) isAdmin = true;
      }
      // Ø§Ø³ØªØ¹Ø§Ø¯Ø© Ø¢Ø®Ø± ÙÙ„Ø§ØªØ±
      if(lastFilters) {
        document.getElementById("search").value = lastFilters.filter||"";
        document.getElementById("filter-province").value = lastFilters.province||"";
        document.getElementById("filter-type").value = lastFilters.type||"";
        document.getElementById("filter-salary").value = lastFilters.salary||"";
      }
      renderJobs();
      updateFavBtns();
      updateStats();
      updateJobsTicker();
    };
    // Ø­ÙØ¸ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ Ø¨Ø¹Ø¯ Ø§Ù„ØªØ³Ø¬ÙŠÙ„
    document.getElementById("modal-next-btn").addEventListener("click", function() {
      if(userData)
        localStorage.setItem("ruyaJobsUser", JSON.stringify(userData));
    });
    // =============== ØªØ­Ù…ÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù PDF =============
    window.exportJobsPDF = function() {
      let win = window.open("","_blank");
      let html = `<h2>Ø¬Ù…ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ§Ø­Ø©</h2><table border="1" style="width:100%;border-collapse:collapse;"><tr><th>Ø§Ù„ÙˆØ¸ÙŠÙØ©</th><th>Ø§Ù„Ø´Ø±ÙƒØ©</th><th>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©</th><th>Ø§Ù„Ø±Ø§ØªØ¨</th><th>Ø§Ù„Ù†ÙˆØ¹</th></tr>`;
      jobsData.forEach(j=>{
        html += `<tr><td>${j.title}</td><td>${j.company}</td><td>${j.province}</td><td>${j.salary}</td><td>${j.type}</td></tr>`;
      });
      html += "</table>";
      win.document.write(html);
      win.print();
    }
    // =============== Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… ========================
    window.openDashboardPanel = function(){
      document.getElementById("dashboard-panel").style.display="flex";
      renderDashboardTabs();
      renderDashboardTab(currentDashboardTab);
    }
    window.closeDashboardPanel = function(){
      document.getElementById("dashboard-panel").style.display="none";
    }
    // Tabs
    function renderDashboardTabs() {
      let tabs = [
        {key:"myapps",label:"Ø·Ù„Ø¨Ø§ØªÙŠ"},
        {key:"fav",label:"Ø§Ù„Ù…ÙØ¶Ù„Ø©"},
        {key:"cv",label:"Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©"},
        {key:"profile",label:"Ø¨ÙŠØ§Ù†Ø§ØªÙŠ"},
        {key:"feedback",label:"ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙˆÙ‚Ø¹"},
        {key:"stats",label:"Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª"},
      ];
      if(isAdmin) tabs.push({key:"admin",label:"Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©"});
      let html = "";
      tabs.forEach(tab=>{
        html += `<button class="${currentDashboardTab===tab.key?'active':''}" onclick="renderDashboardTab('${tab.key}')">${tab.label}</button>`;
      });
      document.getElementById("dashboard-tabs").innerHTML = html;
    }
    // Ù…Ø­ØªÙˆÙ‰ Ø§Ù„ØªØ§Ø¨
    window.renderDashboardTab = function(tab) {
      currentDashboardTab = tab;
      renderDashboardTabs();
      let content = "";
      if(tab==="myapps") {
        // Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
        let myapps = allApplications.filter(a=>a.phone===userData.phone);
        content += `<h3>Ø·Ù„Ø¨Ø§ØªÙŠ Ø§Ù„Ù…Ù‚Ø¯Ù…Ø©</h3>`;
        if(!myapps.length) content += "<div>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯.</div>";
        else myapps.forEach(a=>{
          content += `<div style="border-bottom:1px solid #ddd;margin-bottom:8px;">
            <b>${a.jobTitle}</b> - <span style="color:#6900ad;">${a.status||"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"}</span>
            <div>Ø§Ù„Ø´Ø±ÙƒØ©: ${a.company||"--"} | Ø§Ù„Ø±Ø§ØªØ¨: ${a.salary} | Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${a.province}</div>
            <div>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø¯ÙŠÙ…: ${new Date(a.timestamp).toLocaleString("ar-EG")}</div>
            <div>Ø­Ø§Ù„Ø© Ø§Ù„Ø·Ù„Ø¨: <b>${a.status||"Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©"}</b></div>
            <button onclick="showStepModal('accepted')">Ù…ØªØ§Ø¨Ø¹Ø© Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</button>
          </div>`;
        });
      }
      else if(tab==="fav") {
        // Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ÙØ¶Ù„Ø©
        content += "<h3>ÙˆØ¸Ø§Ø¦ÙÙŠ Ø§Ù„Ù…ÙØ¶Ù„Ø©</h3>";
        if(!favJobs.length) content += "<div>Ù„Ø§ ÙŠÙˆØ¬Ø¯ ÙˆØ¸Ø§Ø¦Ù Ù…Ø­ÙÙˆØ¸Ø©.</div>";
        else favJobs.forEach(idx=>{
          let job = jobsData[idx];
          if(job) content += `<div style="border-bottom:1px solid #ddd;margin-bottom:8px;">
            <b>${job.title}</b> | <span>${job.company}</span> | <span>${job.province}</span>
            <button onclick="applyJob(${idx})" style="margin:5px;">ØªÙ‚Ø¯ÙŠÙ…</button>
            <button onclick="toggleFav(${idx})" style="margin:5px;">Ø¥Ø²Ø§Ù„Ø©</button>
          </div>`;
        });
      }
      else if(tab==="cv") {
        // Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©
        let mycv = allCVs.find(c=>c.phone===userData.phone);
        content += "<h3>Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©</h3>";
        content += `<textarea id="cv-text" style="width:97%;height:100px;border-radius:8px;padding:8px;margin-bottom:7px;">${mycv?mycv.cv:""}</textarea>`;
        content += `<button onclick="saveMyCV()">Ø­ÙØ¸ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©</button>`;
        if(mycv && mycv.cv) content += `<div class="cv-preview"><b>Ù…Ø¹Ø§ÙŠÙ†Ø©:</b><br>${mycv.cv.replace(/\n/g,"<br>")}</div>`;
        window.saveMyCV = function(){
          saveCVToFirebase(userData, document.getElementById("cv-text").value);
          showToast("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø³ÙŠØ±Ø© Ø§Ù„Ø°Ø§ØªÙŠØ©!");
        }
      }
      else if(tab==="profile") {
        // Ø¨ÙŠØ§Ù†Ø§ØªÙŠ
        content += "<h3>Ø¨ÙŠØ§Ù†Ø§ØªÙŠ Ø§Ù„Ø´Ø®ØµÙŠØ©</h3>";
        content += `<div>Ø§Ù„Ø§Ø³Ù…: ${userData.name}</div>
        <div>Ø§Ù„Ù‡Ø§ØªÙ: ${userData.phone}</div>
        <div>Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©: ${userData.province}</div>
        <div>Ø§Ù„Ø¨Ø±ÙŠØ¯ Ø§Ù„Ø¥Ù„ÙƒØªØ±ÙˆÙ†ÙŠ: ${userData.email||"--"}</div>
        <button onclick="logout()" style="margin-top:14px;background:#f9d13d;color:#6900ad;">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>`;
        window.logout = function(){
          localStorage.removeItem("ruyaJobsUser");
          location.reload();
        }
      }
      else if(tab==="feedback") {
        // ØªÙ‚ÙŠÙŠÙ… Ø§Ù„Ù…ÙˆÙ‚Ø¹
        content += "<h3>ØªÙ‚ÙŠÙŠÙ… ØªØ¬Ø±Ø¨ØªÙƒ ÙÙŠ Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>";
        content += `<div class="rating-stars" id="site-rate-stars">${[1,2,3,4,5].map(i=>`<span style="color:#f9d13d;" onclick="setSiteRate(${i})">â˜…</span>`).join("")}</div>
        <textarea id="site-feedback" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)" style="height:60px;"></textarea>
        <button onclick="saveSiteFeedback()" style="margin-top:12px;">Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ØªÙ‚ÙŠÙŠÙ…</button>`;
        window.setSiteRate = function(val){document.getElementById("site-rate-stars").innerHTML=[1,2,3,4,5].map(i=>`<span style="color:${i<=val?"#f9d13d":"#ccc"};" onclick="setSiteRate(${i})">â˜…</span>`).join(""); window.siteRating=val;}
        window.saveSiteFeedback = function(){
          if(!window.siteRating) return showToast("ÙŠØ±Ø¬Ù‰ Ø§Ø®ØªÙŠØ§Ø± Ø¹Ø¯Ø¯ Ø§Ù„Ù†Ø¬ÙˆÙ…");
          showToast("Ø´ÙƒØ±Ù‹Ø§ Ù„Ù…Ù„Ø§Ø­Ø¸Ø§ØªÙƒ!");
          // ÙŠÙ…ÙƒÙ†Ùƒ Ø­ÙØ¸ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… ÙÙŠ ÙØ§ÙŠØ±Ø¨ÙŠØ³ Ù‡Ù†Ø§ Ù„Ùˆ Ø£Ø±Ø¯Øª
        }
      }
      else if(tab==="stats") {
        // Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
        content += "<h3>Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„Ù…ÙˆÙ‚Ø¹</h3>";
        content += `<div>Ø¹Ø¯Ø¯ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù: ${jobsData.length}</div>
        <div>Ø¹Ø¯Ø¯ Ø§Ù„Ø·Ù„Ø¨Ø§Øª: ${allApplications.length}</div>
        <div>Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙˆÙ†: ${allUsers.length}</div>
        <div>Ø§Ù„Ù…ØªÙ‚Ø¯Ù…ÙˆÙ† Ø§Ù„ÙŠÙˆÙ…: ${allApplications.filter(a=>a.timestamp && new Date(a.timestamp).toDateString()===new Date().toDateString()).length}</div>`;
        // Ø±Ø³Ù… Ø¨ÙŠØ§Ù†ÙŠ Ø¨Ø³ÙŠØ· (Ù†Øµ)
        let jobsPerProvince = {};
        jobsData.forEach(j=>{jobsPerProvince[j.province]=(jobsPerProvince[j.province]||0)+1;});
        content += "<h4>ØªÙˆØ²ÙŠØ¹ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø­Ø³Ø¨ Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©:</h4><div style='font-size:.99rem;'>";
        Object.keys(jobsPerProvince).forEach(p=>{content += `${p}: <span style="color:#6900ad;">${jobsPerProvince[p]}</span><br>`;});
        content += "</div>";
      }
      else if(tab==="admin") {
        // Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©
        if(!isAdmin) return content += "<div>ØºÙŠØ± Ù…ØµØ±Ø­ Ù„Ùƒ Ø¨Ø§Ù„Ø¯Ø®ÙˆÙ„.</div>";
        content += "<h3>Ù„ÙˆØ­Ø© ØªØ­ÙƒÙ… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©</h3>";
        content += "<b>Ø¥Ø¶Ø§ÙØ© ÙˆØ¸ÙŠÙØ© Ø¬Ø¯ÙŠØ¯Ø©:</b><br><input id='add-title' placeholder='Ø§Ø³Ù… Ø§Ù„ÙˆØ¸ÙŠÙØ©' style='width:90%;'><br>";
        content += "<input id='add-company' placeholder='Ø§Ø³Ù… Ø§Ù„Ø´Ø±ÙƒØ©' style='width:90%;'><br>";
        content += "<input id='add-salary' type='number' placeholder='Ø§Ù„Ø±Ø§ØªØ¨' style='width:90%;'><br>";
        content += "<input id='add-hours' type='number' placeholder='Ø¹Ø¯Ø¯ Ø§Ù„Ø³Ø§Ø¹Ø§Øª' style='width:90%;'><br>";
        content += "<input id='add-province' placeholder='Ø§Ù„Ù…Ø­Ø§ÙØ¸Ø©' style='width:90%;'><br>";
        content += "<input id='add-type' placeholder='Ù†ÙˆØ¹ Ø§Ù„Ø¯ÙˆØ§Ù…' style='width:90%;'><br>";
        content += "<input id='add-exp' placeholder='Ø§Ù„Ø®Ø¨Ø±Ø©' style='width:90%;'><br>";
        content += "<input id='add-img' placeholder='Ø±Ù…Ø²/Ø¥ÙŠÙ…ÙˆØ¬ÙŠ' style='width:90%;'><br>";
        content += "<input id='add-desc' placeholder='ÙˆØµÙ Ø§Ù„ÙˆØ¸ÙŠÙØ©' style='width:90%;'><br>";
        content += "<input id='add-video' placeholder='Ø±Ø§Ø¨Ø· ÙÙŠØ¯ÙŠÙˆ (Ø§Ø®ØªÙŠØ§Ø±ÙŠ)' style='width:90%;'><br>";
        content += "<button onclick='addNewJob()' style='margin-top:8px;'>Ø¥Ø¶Ø§ÙØ©</button>";
        content += "<hr>";
        content += "<b>ÙƒÙ„ Ø§Ù„ÙˆØ¸Ø§Ø¦Ù:</b>";
        jobsData.forEach((j,i)=>{
          content += `<div style='border-bottom:1px solid #eee;'><b>${j.title}</b> - ${j.company} | <button onclick='deleteJob(${i})' style='background:#b30000;color:#fff;border:none;border-radius:5px;padding:3px 7px;cursor:pointer;'>Ø­Ø°Ù</button></div>`;
        });
        window.addNewJob = function(){
          let n = { title:document.getElementById("add-title").value, company:document.getElementById("add-company").value, salary:+document.getElementById("add-salary").value, hours:+document.getElementById("add-hours").value, province:document.getElementById("add-province").value, type:document.getElementById("add-type").value, exp:document.getElementById("add-exp").value, img:document.getElementById("add-img").value, desc:document.getElementById("add-desc").value, video:document.getElementById("add-video").value };
          window.pushDB(window.refDB(window.db,"jobs"),n);
          showToast("ØªÙ…Øª Ø¥Ø¶Ø§ÙØ© Ø§Ù„ÙˆØ¸ÙŠÙØ©!");
        }
        window.deleteJob = function(i){
          if(!confirm("Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ø§Ù„ÙˆØ¸ÙŠÙØ©ØŸ")) return;
          let key = jobsKeys[i];
          if(key.startsWith("demo")) showToast("Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø­Ø°Ù Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„ØªØ¬Ø±ÙŠØ¨ÙŠØ©"); else window.removeDB(window.refDB(window.db,"jobs/"+key));
        }
      }
      document.getElementById("dashboard-content").innerHTML = content;
    }
  </script>
</body>
</html>